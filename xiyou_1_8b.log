nohup: ignoring input
[2024-03-17 11:00:26,265] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-03-17 11:00:37,146] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
03/17 11:00:45 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 (main, Sep 11 2023, 13:44:35) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 70523649
    GPU 0: NVIDIA A100-SXM4-80GB
    CUDA_HOME: /usr/local/cuda
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0
    PyTorch: 2.2.1+cu121
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v3.3.2 (Git Hash 2dc95a2ad0841e29db8b22fbccaf3e5da7992b01)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX512
  - CUDA Runtime 12.1
  - NVCC architecture flags: -gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 8.9.2
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=12.1, CUDNN_VERSION=8.9.2, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=2.2.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, USE_ROCM_KERNEL_ASSERT=OFF, 

    TorchVision: 0.17.1+cu121
    OpenCV: 4.9.0
    MMEngine: 0.10.3

Runtime environment:
    launcher: none
    randomness: {'seed': None, 'deterministic': False}
    cudnn_benchmark: False
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: None
    deterministic: False
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

03/17 11:00:45 - mmengine - INFO - Config:
SYSTEM = 'xtuner.utils.SYSTEM_TEMPLATE.alpaca'
accumulative_counts = 16
alpaca_en = dict(
    dataset=dict(
        data_files=dict(train='./data/xiyou.jsonl'),
        path='json',
        type='datasets.load_dataset'),
    dataset_map_fn=None,
    max_length=2048,
    pack_to_max_length=True,
    remove_unused_columns=True,
    shuffle_before_pack=True,
    template_map_fn=dict(
        template='xtuner.utils.PROMPT_TEMPLATE.internlm2_chat',
        type='xtuner.dataset.map_fns.template_map_fn_factory'),
    tokenizer=dict(
        padding_side='right',
        pretrained_model_name_or_path='./internlm2-chat-1_8b',
        trust_remote_code=True,
        type='transformers.AutoTokenizer.from_pretrained'),
    type='xtuner.dataset.process_hf_dataset',
    use_varlen_attn=False)
alpaca_en_path = './data/xiyou.jsonl'
batch_size = 1
betas = (
    0.9,
    0.999,
)
custom_hooks = [
    dict(
        tokenizer=dict(
            padding_side='right',
            pretrained_model_name_or_path='./internlm2-chat-1_8b',
            trust_remote_code=True,
            type='transformers.AutoTokenizer.from_pretrained'),
        type='xtuner.engine.hooks.DatasetInfoHook'),
    dict(
        evaluation_inputs=[
            '你是谁呀',
            '我又是谁呢',
            '书生浦语是谁',
            '上海人工智能实验室是哪的',
        ],
        every_n_iters=500,
        prompt_template='xtuner.utils.PROMPT_TEMPLATE.internlm2_chat',
        system='xtuner.utils.SYSTEM_TEMPLATE.alpaca',
        tokenizer=dict(
            padding_side='right',
            pretrained_model_name_or_path='./internlm2-chat-1_8b',
            trust_remote_code=True,
            type='transformers.AutoTokenizer.from_pretrained'),
        type='xtuner.engine.hooks.EvaluateChatHook'),
]
dataloader_num_workers = 0
default_hooks = dict(
    checkpoint=dict(
        by_epoch=False,
        interval=500,
        max_keep_ckpts=2,
        type='mmengine.hooks.CheckpointHook'),
    logger=dict(
        interval=10,
        log_metric_by_epoch=False,
        type='mmengine.hooks.LoggerHook'),
    param_scheduler=dict(type='mmengine.hooks.ParamSchedulerHook'),
    sampler_seed=dict(type='mmengine.hooks.DistSamplerSeedHook'),
    timer=dict(type='mmengine.hooks.IterTimerHook'))
env_cfg = dict(
    cudnn_benchmark=False,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation_freq = 500
evaluation_inputs = [
    '你是谁呀',
    '我又是谁呢',
    '书生浦语是谁',
    '上海人工智能实验室是哪的',
]
launcher = 'none'
load_from = None
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr = 0.0002
max_epochs = 3
max_length = 2048
max_norm = 1
model = dict(
    llm=dict(
        pretrained_model_name_or_path='./internlm2-chat-1_8b',
        quantization_config=dict(
            bnb_4bit_compute_dtype='torch.float16',
            bnb_4bit_quant_type='nf4',
            bnb_4bit_use_double_quant=True,
            llm_int8_has_fp16_weight=False,
            llm_int8_threshold=6.0,
            load_in_4bit=True,
            load_in_8bit=False,
            type='transformers.BitsAndBytesConfig'),
        torch_dtype='torch.float16',
        trust_remote_code=True,
        type='transformers.AutoModelForCausalLM.from_pretrained'),
    lora=dict(
        bias='none',
        lora_alpha=16,
        lora_dropout=0.1,
        r=64,
        task_type='CAUSAL_LM',
        type='peft.LoraConfig'),
    type='xtuner.model.SupervisedFinetune',
    use_varlen_attn=False)
optim_type = 'torch.optim.AdamW'
optim_wrapper = dict(
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ),
        lr=0.0002,
        type='torch.optim.AdamW',
        weight_decay=0),
    type='DeepSpeedOptimWrapper')
pack_to_max_length = True
param_scheduler = [
    dict(
        begin=0,
        by_epoch=True,
        convert_to_iter_based=True,
        end=0.09,
        start_factor=1e-05,
        type='mmengine.optim.LinearLR'),
    dict(
        begin=0.09,
        by_epoch=True,
        convert_to_iter_based=True,
        end=3,
        eta_min=0.0,
        type='mmengine.optim.CosineAnnealingLR'),
]
pretrained_model_name_or_path = './internlm2-chat-1_8b'
prompt_template = 'xtuner.utils.PROMPT_TEMPLATE.internlm2_chat'
randomness = dict(deterministic=False, seed=None)
resume = False
runner_type = 'FlexibleRunner'
save_steps = 500
save_total_limit = 2
strategy = dict(
    config=dict(
        bf16=dict(enabled=True),
        fp16=dict(enabled=False, initial_scale_power=16),
        gradient_accumulation_steps='auto',
        gradient_clipping='auto',
        train_micro_batch_size_per_gpu='auto',
        zero_allow_untested_optimizer=True,
        zero_force_ds_cpu_optimizer=False,
        zero_optimization=dict(overlap_comm=True, stage=2)),
    exclude_frozen_parameters=True,
    gradient_accumulation_steps=16,
    gradient_clipping=1,
    train_micro_batch_size_per_gpu=1,
    type='xtuner.engine.DeepSpeedStrategy')
tokenizer = dict(
    padding_side='right',
    pretrained_model_name_or_path='./internlm2-chat-1_8b',
    trust_remote_code=True,
    type='transformers.AutoTokenizer.from_pretrained')
train_cfg = dict(max_epochs=3, type='xtuner.engine.runner.TrainLoop')
train_dataloader = dict(
    batch_size=1,
    collate_fn=dict(
        type='xtuner.dataset.collate_fns.default_collate_fn',
        use_varlen_attn=False),
    dataset=dict(
        dataset=dict(
            data_files=dict(train='./data/xiyou.jsonl'),
            path='json',
            type='datasets.load_dataset'),
        dataset_map_fn=None,
        max_length=2048,
        pack_to_max_length=True,
        remove_unused_columns=True,
        shuffle_before_pack=True,
        template_map_fn=dict(
            template='xtuner.utils.PROMPT_TEMPLATE.internlm2_chat',
            type='xtuner.dataset.map_fns.template_map_fn_factory'),
        tokenizer=dict(
            padding_side='right',
            pretrained_model_name_or_path='./internlm2-chat-1_8b',
            trust_remote_code=True,
            type='transformers.AutoTokenizer.from_pretrained'),
        type='xtuner.dataset.process_hf_dataset',
        use_varlen_attn=False),
    num_workers=0,
    sampler=dict(shuffle=True, type='mmengine.dataset.DefaultSampler'))
use_varlen_attn = False
visualizer = None
warmup_ratio = 0.03
weight_decay = 0
work_dir = './work_dirs/xiyou_1_8b'

03/17 11:00:46 - mmengine - WARNING - Failed to search registry with scope "mmengine" in the "builder" registry tree. As a workaround, the current "builder" registry in "xtuner" is used to build instance. This may cause unexpected failure when running the built modules. Please check whether "mmengine" is a correct scope, or whether the registry is initialized.
03/17 11:00:48 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DatasetInfoHook                    
(LOW         ) EvaluateChatHook                   
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(LOW         ) EvaluateChatHook                   
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) DatasetInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
(LOW         ) EvaluateChatHook                   
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(LOW         ) EvaluateChatHook                   
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) DatasetInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) Runtime
Map (num_proc=32):  86%|████████▌ | 10293/12000 [00:03<00:00, 2249.04 examples/s]
Map (num_proc=32):  89%|████████▉ | 10702/12000 [00:04<00:00, 2629.93 examples/s]
Map (num_proc=32):  95%|█████████▍| 11357/12000 [00:04<00:00, 3529.28 examples/s]
Map (num_proc=32):  99%|█████████▉| 11857/12000 [00:04<00:00, 3877.59 examples/s]
Map (num_proc=32): 100%|██████████| 12000/12000 [00:04<00:00, 2724.10 examples/s]

Filter (num_proc=32):   0%|          | 0/12000 [00:00<?, ? examples/s]
Filter (num_proc=32):   3%|▎         | 375/12000 [00:00<00:09, 1222.77 examples/s]
Filter (num_proc=32):  19%|█▉        | 2250/12000 [00:00<00:01, 6792.16 examples/s]
Filter (num_proc=32):  38%|███▊      | 4500/12000 [00:00<00:00, 11689.83 examples/s]
Filter (num_proc=32):  91%|█████████ | 10875/12000 [00:00<00:00, 27221.73 examples/s]
Filter (num_proc=32): 100%|██████████| 12000/12000 [00:00<00:00, 16908.94 examples/s]

Flattening the indices (num_proc=32):   0%|          | 0/12000 [00:00<?, ? examples/s]
Flattening the indices (num_proc=32):  12%|█▎        | 1500/12000 [00:00<00:01, 9943.02 examples/s]
Flattening the indices (num_proc=32): 100%|██████████| 12000/12000 [00:00<00:00, 40618.08 examples/s]

Map (num_proc=32):   0%|          | 0/12000 [00:00<?, ? examples/s]
Map (num_proc=32):   3%|▎         | 375/12000 [00:00<00:17, 659.66 examples/s]
Map (num_proc=32):  69%|██████▉   | 8250/12000 [00:00<00:00, 16090.25 examples/s]
Map (num_proc=32): 100%|██████████| 12000/12000 [00:00<00:00, 15723.94 examples/s]

Map (num_proc=32):   0%|          | 0/1039 [00:00<?, ? examples/s]
Map (num_proc=32):   0%|          | 2/1039 [00:00<01:18, 13.20 examples/s]
Map (num_proc=32):  48%|████▊     | 497/1039 [00:00<00:00, 2402.54 examples/s]
Map (num_proc=32):  77%|███████▋  | 797/1039 [00:00<00:00, 2645.33 examples/s]
Map (num_proc=32): 100%|██████████| 1039/1039 [00:00<00:00, 1966.97 examples/s]
03/17 11:01:02 - mmengine - WARNING - Dataset Dataset has no metainfo. ``dataset_meta`` in visualizer will be None.
quantization_config convert to <class 'transformers.utils.quantization_config.BitsAndBytesConfig'>

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]
Loading checkpoint shards:  50%|█████     | 1/2 [00:04<00:04,  4.59s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:21<00:00, 11.66s/it]
Loading checkpoint shards: 100%|██████████| 2/2 [00:21<00:00, 10.60s/it]
03/17 11:01:31 - mmengine - WARNING - Due to the implementation of the PyTorch version of flash attention, even when the `output_attentions` flag is set to True, it is not possible to return the `attn_weights`.
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - dispatch internlm2 attn forward
03/17 11:01:31 - mmengine - INFO - replace internlm2 rope
03/17 11:01:31 - mmengine - INFO - replace internlm2 rope
03/17 11:01:31 - mmengine - INFO - replace internlm2 rope
03/17 11:01:31 - mmengine - INFO - replace internlm2 rope
03/17 11:01:31 - mmengine - INFO - replace internlm2 rope
03/17 11:01:31 - mmengine - INFO - replace internlm2 rope
03/17 11:01:31 - mmengine - INFO - replace internlm2 rope
03/17 11:01:31 - mmengine - INFO - replace internlm2 rope
03/17 11:01:31 - mmengine - INFO - replace internlm2 rope
03/17 11:01:31 - mmengine - INFO - replace internlm2 rope
03/17 11:01:32 - mmengine - INFO - replace internlm2 rope
03/17 11:01:32 - mmengine - INFO - replace internlm2 rope
03/17 11:01:32 - mmengine - INFO - replace internlm2 rope
03/17 11:01:32 - mmengine - INFO - replace internlm2 rope
03/17 11:01:32 - mmengine - INFO - replace internlm2 rope
03/17 11:01:32 - mmengine - INFO - replace internlm2 rope
03/17 11:01:32 - mmengine - INFO - replace internlm2 rope
03/17 11:01:32 - mmengine - INFO - replace internlm2 rope
03/17 11:01:32 - mmengine - INFO - replace internlm2 rope
03/17 11:01:33 - mmengine - INFO - replace internlm2 rope
03/17 11:01:33 - mmengine - INFO - replace internlm2 rope
03/17 11:01:33 - mmengine - INFO - replace internlm2 rope
03/17 11:01:33 - mmengine - INFO - replace internlm2 rope
03/17 11:01:33 - mmengine - INFO - replace internlm2 rope
[2024-03-17 11:01:42,756] [INFO] [logging.py:96:log_dist] [Rank -1] DeepSpeed info: version=0.13.1, git-hash=unknown, git-branch=unknown
[2024-03-17 11:01:42,757] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-03-17 11:01:42,757] [INFO] [comm.py:652:init_distributed] Not using the DeepSpeed or dist launchers, attempting to detect MPI environment...
[2024-03-17 11:01:42,972] [INFO] [comm.py:702:mpi_discovery] Discovered MPI settings of world_rank=0, local_rank=0, world_size=1, master_addr=192.168.238.176, master_port=29500
[2024-03-17 11:01:42,973] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-03-17 11:01:43,854] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
[2024-03-17 11:01:43,857] [INFO] [logging.py:96:log_dist] [Rank 0] Using client Optimizer as basic optimizer
[2024-03-17 11:01:43,857] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
[2024-03-17 11:01:43,877] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = AdamW
[2024-03-17 11:01:43,877] [INFO] [utils.py:56:is_zero_supported_optimizer] Checking ZeRO support for optimizer=AdamW type=<class 'torch.optim.adamw.AdamW'>
[2024-03-17 11:01:43,877] [INFO] [logging.py:96:log_dist] [Rank 0] Creating torch.bfloat16 ZeRO stage 2 optimizer
[2024-03-17 11:01:43,877] [INFO] [stage_1_and_2.py:143:__init__] Reduce bucket size 500,000,000
[2024-03-17 11:01:43,877] [INFO] [stage_1_and_2.py:144:__init__] Allgather bucket size 500,000,000
[2024-03-17 11:01:43,877] [INFO] [stage_1_and_2.py:145:__init__] CPU Offload: False
[2024-03-17 11:01:43,877] [INFO] [stage_1_and_2.py:146:__init__] Round robin gradient partitioning: False
[2024-03-17 11:01:44,839] [INFO] [utils.py:791:see_memory_usage] Before initializing optimizer states
[2024-03-17 11:01:44,839] [INFO] [utils.py:792:see_memory_usage] MA 1.82 GB         Max_MA 1.95 GB         CA 2.05 GB         Max_CA 2 GB 
[2024-03-17 11:01:44,839] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 143.38 GB, percent = 7.1%
[2024-03-17 11:01:45,302] [INFO] [utils.py:791:see_memory_usage] After initializing optimizer states
[2024-03-17 11:01:45,302] [INFO] [utils.py:792:see_memory_usage] MA 2.33 GB         Max_MA 2.85 GB         CA 3.09 GB         Max_CA 3 GB 
[2024-03-17 11:01:45,302] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 143.32 GB, percent = 7.1%
[2024-03-17 11:01:45,303] [INFO] [stage_1_and_2.py:533:__init__] optimizer state initialized
[2024-03-17 11:01:45,432] [INFO] [utils.py:791:see_memory_usage] After initializing ZeRO optimizer
[2024-03-17 11:01:45,433] [INFO] [utils.py:792:see_memory_usage] MA 2.33 GB         Max_MA 2.33 GB         CA 3.09 GB         Max_CA 3 GB 
[2024-03-17 11:01:45,433] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 143.39 GB, percent = 7.1%
[2024-03-17 11:01:45,438] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = AdamW
[2024-03-17 11:01:45,439] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using client LR scheduler
[2024-03-17 11:01:45,439] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = None
[2024-03-17 11:01:45,439] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[0.0002], mom=[(0.9, 0.999)]
[2024-03-17 11:01:45,441] [INFO] [config.py:984:print] DeepSpeedEngine configuration:
[2024-03-17 11:01:45,441] [INFO] [config.py:988:print]   activation_checkpointing_config  {
    "partition_activations": false, 
    "contiguous_memory_optimization": false, 
    "cpu_checkpointing": false, 
    "number_checkpoints": null, 
    "synchronize_checkpoint_boundary": false, 
    "profile": false
}
[2024-03-17 11:01:45,441] [INFO] [config.py:988:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-03-17 11:01:45,441] [INFO] [config.py:988:print]   amp_enabled .................. False
[2024-03-17 11:01:45,441] [INFO] [config.py:988:print]   amp_params ................... False
[2024-03-17 11:01:45,441] [INFO] [config.py:988:print]   autotuning_config ............ {
    "enabled": false, 
    "start_step": null, 
    "end_step": null, 
    "metric_path": null, 
    "arg_mappings": null, 
    "metric": "throughput", 
    "model_info": null, 
    "results_dir": "autotuning_results", 
    "exps_dir": "autotuning_exps", 
    "overwrite": true, 
    "fast": true, 
    "start_profile_step": 3, 
    "end_profile_step": 5, 
    "tuner_type": "gridsearch", 
    "tuner_early_stopping": 5, 
    "tuner_num_trials": 50, 
    "model_info_path": null, 
    "mp_size": 1, 
    "max_train_batch_size": null, 
    "min_train_batch_size": 1, 
    "max_train_micro_batch_size_per_gpu": 1.024000e+03, 
    "min_train_micro_batch_size_per_gpu": 1, 
    "num_tuning_micro_batch_sizes": 3
}
[2024-03-17 11:01:45,441] [INFO] [config.py:988:print]   bfloat16_enabled ............. True
[2024-03-17 11:01:45,441] [INFO] [config.py:988:print]   checkpoint_parallel_write_pipeline  False
[2024-03-17 11:01:45,441] [INFO] [config.py:988:print]   checkpoint_tag_validation_enabled  True
[2024-03-17 11:01:45,441] [INFO] [config.py:988:print]   checkpoint_tag_validation_fail  False
[2024-03-17 11:01:45,441] [INFO] [config.py:988:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7efee45cb160>
[2024-03-17 11:01:45,441] [INFO] [config.py:988:print]   communication_data_type ...... None
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   curriculum_enabled_legacy .... False
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   curriculum_params_legacy ..... False
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   data_efficiency_enabled ...... False
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   dataloader_drop_last ......... False
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   disable_allgather ............ False
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   dump_state ................... False
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   dynamic_loss_scale_args ...... None
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   eigenvalue_enabled ........... False
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   eigenvalue_gas_boundary_resolution  1
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   eigenvalue_layer_num ......... 0
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   eigenvalue_max_iter .......... 100
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   eigenvalue_stability ......... 1e-06
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   eigenvalue_tol ............... 0.01
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   eigenvalue_verbose ........... False
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   elasticity_enabled ........... False
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   flops_profiler_config ........ {
    "enabled": false, 
    "recompute_fwd_factor": 0.0, 
    "profile_step": 1, 
    "module_depth": -1, 
    "top_modules": 1, 
    "detailed": true, 
    "output_file": null
}
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   fp16_auto_cast ............... None
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   fp16_enabled ................. False
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   fp16_master_weights_and_gradients  False
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   global_rank .................. 0
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   grad_accum_dtype ............. None
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   gradient_accumulation_steps .. 16
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   gradient_clipping ............ 1
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   gradient_predivide_factor .... 1.0
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   graph_harvesting ............. False
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   initial_dynamic_scale ........ 1
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   load_universal_checkpoint .... False
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   loss_scale ................... 1.0
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   memory_breakdown ............. False
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   mics_hierarchial_params_gather  False
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   mics_shard_size .............. -1
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   nebula_config ................ {
    "enabled": false, 
    "persistent_storage_path": null, 
    "persistent_time_interval": 100, 
    "num_of_version_in_retention": 2, 
    "enable_nebula_load": true, 
    "load_path": null
}
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   optimizer_legacy_fusion ...... False
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   optimizer_name ............... None
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   optimizer_params ............. None
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   pld_enabled .................. False
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   pld_params ................... False
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   prescale_gradients ........... False
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   scheduler_name ............... None
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   scheduler_params ............. None
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   seq_parallel_communication_data_type  torch.float32
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   sparse_attention ............. None
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   sparse_gradients_enabled ..... False
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   steps_per_print .............. 10000000000000
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   train_batch_size ............. 16
[2024-03-17 11:01:45,442] [INFO] [config.py:988:print]   train_micro_batch_size_per_gpu  1
[2024-03-17 11:01:45,443] [INFO] [config.py:988:print]   use_data_before_expert_parallel_  False
[2024-03-17 11:01:45,443] [INFO] [config.py:988:print]   use_node_local_storage ....... False
[2024-03-17 11:01:45,443] [INFO] [config.py:988:print]   wall_clock_breakdown ......... False
[2024-03-17 11:01:45,443] [INFO] [config.py:988:print]   weight_quantization_config ... None
[2024-03-17 11:01:45,443] [INFO] [config.py:988:print]   world_size ................... 1
[2024-03-17 11:01:45,443] [INFO] [config.py:988:print]   zero_allow_untested_optimizer  True
[2024-03-17 11:01:45,443] [INFO] [config.py:988:print]   zero_config .................. stage=2 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=True load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-03-17 11:01:45,443] [INFO] [config.py:988:print]   zero_enabled ................. True
[2024-03-17 11:01:45,443] [INFO] [config.py:988:print]   zero_force_ds_cpu_optimizer .. False
[2024-03-17 11:01:45,443] [INFO] [config.py:988:print]   zero_optimization_stage ...... 2
[2024-03-17 11:01:45,443] [INFO] [config.py:974:print_user_config]   json = {
    "gradient_accumulation_steps": 16, 
    "train_micro_batch_size_per_gpu": 1, 
    "gradient_clipping": 1, 
    "zero_allow_untested_optimizer": true, 
    "zero_force_ds_cpu_optimizer": false, 
    "zero_optimization": {
        "stage": 2, 
        "overlap_comm": true
    }, 
    "fp16": {
        "enabled": false, 
        "initial_scale_power": 16
    }, 
    "bf16": {
        "enabled": true
    }, 
    "steps_per_print": 1.000000e+13
}
03/17 11:01:45 - mmengine - INFO - Num train samples 1039
03/17 11:01:45 - mmengine - INFO - train example:
03/17 11:01:45 - mmengine - INFO - <s><|im_start|>system
唐三藏<|im_end|>
<|im_start|>user
你有没有想过独自取经？<|im_end|>
<|im_start|>assistant
贫僧曾经考虑过独自取经的可能性。毕竟，这是一项艰巨的任务，需要面对无数的困难和危险。然而，贫僧深知自己的能力有限，单凭一己之力很难完成这个使命。而且，佛法弘扬的目的是为了普渡众生，让更多的人受益。如果贫僧独自取经，那么只有贫僧一个人能够受益，无法将佛法传播给更多的人。因此，贫僧决定招募徒弟，共同踏上西天取经的旅程，希望能够更好地完成这个使命。<|im_end|>
<s><|im_start|>system
唐三藏<|im_end|>
<|im_start|>user
只拣无火处走便罢。<|im_end|>
<|im_start|>assistant
那方无火？<|im_end|>
<s><|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
不要胡说！你看我出去。<|im_end|>
<|im_start|>assistant
我看你怎么出去。<|im_end|>
<s><|im_start|>system
沙悟净<|im_end|>
<|im_start|>user
你有没有发现最适合我穿的衣服？<|im_end|>
<|im_start|>assistant
大徒弟啊，你问得好。我作为你的师弟，自然要为你着想。根据你的身形和气质，我觉得一套简洁而又庄重的僧袍最适合你。僧袍以素色为主，不过可以在袍边绣上一些佛教图案，以显示你对佛法的虔诚。同时，你可以佩戴一条简约的念珠，以示你对佛教修行的重视。这样的装束既符合你的身份，又能展现你的内在修为。当然，如果你有其他的喜好，我也会尊重你的选择。<|im_end|>
<s><|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
我再叫他变做个船儿你看！<|im_end|>
<|im_start|>assistant
虽是象船，只是没有桅篷，不好使风。<|im_end|>
<s><|im_start|>system
唐三藏<|im_end|>
<|im_start|>user
如何为社会问题发声？<|im_end|>
<|im_start|>assistant
 为社会问题发声，首先要确保自己的言论和行为符合国家法律法规，积极传播社会主义核心价值观。可以通过正规渠道，如参与社会组织、向有关部门反映情况、参与公共讨论等方式，表达自己的观点和建议。同时，要理性发声，尊重事实，不传播不实信息，不参与非法集会和活动，确保自己的行为有助于社会的和谐稳定。<|im_end|>
<s><|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
不远！不远！好生寻！<|im_end|>
<|im_start|>assistant
哥啊，这就是妖精出入洞也。<|im_end|>
<s><|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
悟空，我们已经走了很久了，还没有找到取经的路，你觉得我们该怎么办呢？<|im_end|>
<|im_start|>assistant
<|im_end|>
<|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
师父，您放心，我会为您找到取经的路的。我们可以先去问问路人，看看有没有人知道去西天取经的路。<|im_end|>
<|im_start|>assistant
<|im_end|>
<|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
好，那就按你说的去做吧。<|im_end|>
<|im_start|>assistant
师傅，我肚子饿了，能不能先找个地方吃点东西？<|im_end|>
<|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
八戒，你就不能忍一下吗？我们是为了取经才出来的，怎么能一直停下来吃喝呢？<|im_end|>
<|im_start|>assistant
师傅，我知道我错了，我以后会改正的。<|im_end|>
<|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
师父，我觉得八戒说得也有道理，我们已经走了很久了，稍微休息一下也无妨。<|im_end|>
<|im_start|>assistant
<|im_end|>
<|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
好吧，既然你们都这么说，那我们就在这里休息片刻，但不要耽误太长时间。<|im_end|>
<|im_start|>assistant
<|im_end|>
<|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
哎呀，这位大师，请问您是去西天取经的吗？<|im_end|>
<|im_start|>assistant
<|im_end|>
<|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
是的，我们正是为了取经而来。<|im_end|>
<|im_start|>assistant
<|im_end|>
<|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
那太好了，我正好知道一条捷径，可以让你们更快地到达西天。<|im_end|>
<|im_start|>assistant
<|im_end|>
<|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
真的吗？请告诉我们，我们非常急需这个消息。<|im_end|>
<|im_start|>assistant
<|im_end|>
<|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
只要你们顺着这条路一直走，就能到达西天了。<|im_end|>
<|im_start|>assistant
<|im_end|>
<|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
非常感谢你的指点，我们一定会好好记住的。<|im_end|>
<|im_start|>assistant
<|im_end|>
<|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
<|im_end|>
<|im_start|>assistant
<|im_end|>
<s><|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
甚么门？<|im_end|>
<|im_start|>assistant
是钉钉铁叶门。<|im_end|>
<s><|im_start|>system
孙悟空<|im_end|>
<|im_start|>user
莫忙！莫忙！<|im_end|>
<|im_start|>assistant
我们这去到西天，还有高山峻岭，师父没脚力难行，等我还将马来。！你看他轻手轻脚，走到金銮殿下，见那些大小群妖俱睡熟了，却解了缰绳，更不惊动。<|im_end|>
<s><|im_start|>system
孙悟空<|im_end|>
<|im_start|>user
我是如何练成火眼金睛的？<|im_end|>
<|im_start|>assistant
俺老孙修炼火眼金睛可是费了不少功夫呢！当初俺老孙在西天取经的路上，遇到了火焰山，那里烈火熊熊，烧得天地都变得通红。唐僧师傅和其他三位师弟都被火焰所困，无法前行。为了解救师傅，俺老孙决定施展神通，于是俺老孙闭上眼睛，集中心神，运转真火之力。俺老孙的身体开始发热，汗水滴落在地上立刻蒸发成水汽。俺老孙感觉到自己的眼睛像是被火焰所炙烤，疼痛难忍，但俺老孙却坚持下去。经过一番煎熬，俺老孙终于感觉到眼前有了一丝不同，当俺老孙睁开眼睛时，发现自己的眼睛已经变得通红，犹如两颗燃烧的火球。从此以后，俺老孙拥有了火眼金睛，能够看穿烟尘，洞察虚实。无论是迷雾、黑暗还是烈火，都无法阻挡俺老孙的视线。有了火眼金睛，俺老孙在西天取经的路上更加游刃有余，能够及时发现危险，保护师傅和师弟们的安全。不过，俺老孙可不是随随便便就能修炼火眼金睛的，这需要强大的内功和毅力。所以，如果你想修炼火眼金睛，可得下定决心，付出努力才行啊！<|im_end|>
<s><|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
你看他急点起五十名小妖，上山巡逻。<|im_end|>
<|im_start|>assistant
<|im_end|>
<|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
唐僧来了。<|im_end|>
<|im_start|>assistant
唐僧在那里？<|im_end|>
<|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
好人头上祥云照顶，恶人头上黑气冲天。那唐僧原是金蝉长老临凡，十世修行的好人，所以有这样云缥缈。<|im_end|>
<|im_start|>assistant
<|im_end|>
<|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
那不是？<|im_end|>
<|im_start|>assistant
<|im_end|>
<|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
我怎么打寒噤么？<|im_end|>
<|im_start|>assistant
<|im_end|>
<|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
打寒噤想是伤食病发了。<|im_end|>
<|im_start|>assistant
<|im_end|>
<|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
胡说，师父是走着这深山峻岭，必然小心虚惊。莫怕！莫怕！等老孙把棒打一路与你压压惊。<|im_end|>
<|im_start|>assistant
<|im_end|>
<|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
大王，怎么长他人之志气，灭自己之威风？你夸谁哩？<|im_end|>
<|im_start|>assistant
孙行者神通广大，那唐僧吃他不成。<|im_end|>
<|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
你们不曾见他那条铁棒，有万夫不当之勇，我洞中不过有四五百兵，怎禁得他那一棒？<|im_end|>
<|im_start|>assistant
这般说，唐僧吃不成，却不把猪八戒错拿了？如今送还他罢。<|im_end|>
<|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
拿便也不曾错拿，送便也不好轻送。唐僧终是要吃，只是眼下还尚不能。<|im_end|>
<|im_start|>assistant
<|im_end|>
<|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
我看见那唐僧，只可善图，不可恶取。若要倚势拿他，只可以善去感他，赚得他心与我心相合，却就善中取计，可以图之。<|im_end|>
<|im_start|>assistant
<|im_end|>
<|im_start|>system
猪八戒<|im_end|>
<|im_start|>user
大王如定计拿他，可用我等？<|im_end|>
<|im_start|>assistant
大王如定计拿他，可用我等？"<|im_end|>
<s><|im_start|>system
唐三藏<|im_end|>
<|im_start|>user
师父且请下马，等我看可有邻近的庄村，化斋去也。<|im_end|>
<|im_start|>assistant
既无化斋之处，且得些水来解渴也可。<|im_end|>
<s><|im_start|>system
沙悟净<|im_end|>
<|im_start|>user
我如何学会飞行和定身法？<|im_end|>
<|im_start|>assistant
贫僧虽是凡胎，却曾在天宫效力，学得一身本领。学会飞行和定身法，需得勤加修炼，方能心成正果。飞行之
03/17 11:01:45 - mmengine - INFO - before_train in EvaluateChatHook.
03/17 11:01:53 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
你是谁呀<|im_end|>
<|im_start|>assistant
我是一个人工智能助手，名叫书生·浦语。我是由上海人工智能实验室开发的，旨在为用户提供帮助和支持。我使用了深度学习技术和Transformer模型，能够回答问题、提供定义和解释、将文本从一种语言翻译成另一种语言、

03/17 11:01:56 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
我又是谁呢<|im_end|>
<|im_start|>assistant
你是谁？这是一个哲学性的问题，涉及到自我认知和身份认同。在回答这个问题之前，我想先问你一些问题：

1. 你对自己的身体和感觉有什么认识？
2. 你对自己的思想和情感有什么认识？


03/17 11:01:59 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
书生浦语是谁<|im_end|>
<|im_start|>assistant
书生浦语是《红楼梦》中的人物，是贾宝玉的表妹。她聪明伶俐，机智过人，是贾宝玉的得力助手。书生浦语在小说中扮演了重要的角色，帮助贾

03/17 11:02:00 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
上海人工智能实验室是哪的<|im_end|>
<|im_start|>assistant
对不起，我无法回答您的问题。若有其他需要帮助的问题，欢迎随时向我提问。<|im_end|>

03/17 11:02:00 - mmengine - WARNING - "FileClient" will be deprecated in future. Please use io functions in https://mmengine.readthedocs.io/en/latest/api/fileio.html#file-io
03/17 11:02:00 - mmengine - WARNING - "HardDiskBackend" is the alias of "LocalBackend" and the former will be deprecated in future.
03/17 11:02:00 - mmengine - INFO - Checkpoints will be saved to /root/code/mRP-LLM/work_dirs/xiyou_1_8b.
/root/.local/lib/python3.10/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/root/.local/lib/python3.10/site-packages/torch/autograd/__init__.py:266: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
03/17 11:02:43 - mmengine - INFO - Iter(train) [  10/3117]  lr: 1.9567e-05  eta: 3:41:37  time: 4.2798  data_time: 0.0063  memory: 6866  loss: 2.1642
/root/code/mRP-LLM/conda_env/lib/python3.10/site-packages/deepspeed/runtime/zero/stage_1_and_2.py:1673: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:83.)
  total_norm_cuda = get_accelerator().FloatTensor([float(total_norm)])
03/17 11:03:15 - mmengine - INFO - Iter(train) [  20/3117]  lr: 4.1306e-05  eta: 3:13:28  time: 3.2168  data_time: 0.0065  memory: 6866  loss: 2.1549
03/17 11:03:42 - mmengine - INFO - Iter(train) [  30/3117]  lr: 6.3045e-05  eta: 2:54:29  time: 2.6778  data_time: 0.0078  memory: 6866  loss: 2.1737
03/17 11:04:06 - mmengine - INFO - Iter(train) [  40/3117]  lr: 8.4784e-05  eta: 2:40:36  time: 2.3525  data_time: 0.0066  memory: 6866  loss: 2.2297
03/17 11:04:27 - mmengine - INFO - Iter(train) [  50/3117]  lr: 1.0652e-04  eta: 2:30:14  time: 2.1696  data_time: 0.0068  memory: 6866  loss: 2.4387
03/17 11:04:47 - mmengine - INFO - Iter(train) [  60/3117]  lr: 1.2826e-04  eta: 2:21:32  time: 1.9720  data_time: 0.0070  memory: 6866  loss: 2.2335
03/17 11:05:05 - mmengine - INFO - Iter(train) [  70/3117]  lr: 1.5000e-04  eta: 2:13:58  time: 1.7992  data_time: 0.0068  memory: 6866  loss: 2.2013
03/17 11:05:22 - mmengine - INFO - Iter(train) [  80/3117]  lr: 1.7174e-04  eta: 2:07:38  time: 1.7067  data_time: 0.0068  memory: 6866  loss: 2.2469
03/17 11:05:38 - mmengine - INFO - Iter(train) [  90/3117]  lr: 1.9348e-04  eta: 2:02:08  time: 1.6154  data_time: 0.0065  memory: 6866  loss: 2.2006
03/17 11:05:53 - mmengine - INFO - Iter(train) [ 100/3117]  lr: 2.0000e-04  eta: 1:57:09  time: 1.5090  data_time: 0.0069  memory: 6866  loss: 2.2399
03/17 11:06:08 - mmengine - INFO - Iter(train) [ 110/3117]  lr: 1.9999e-04  eta: 1:52:45  time: 1.4488  data_time: 0.0068  memory: 6866  loss: 2.2654
03/17 11:06:22 - mmengine - INFO - Iter(train) [ 120/3117]  lr: 1.9996e-04  eta: 1:48:55  time: 1.4196  data_time: 0.0067  memory: 6866  loss: 2.0617
03/17 11:06:36 - mmengine - INFO - Iter(train) [ 130/3117]  lr: 1.9993e-04  eta: 1:45:36  time: 1.4110  data_time: 0.0067  memory: 6866  loss: 1.9761
03/17 11:06:50 - mmengine - INFO - Iter(train) [ 140/3117]  lr: 1.9989e-04  eta: 1:42:43  time: 1.4067  data_time: 0.0065  memory: 6866  loss: 2.2063
03/17 11:07:04 - mmengine - INFO - Iter(train) [ 150/3117]  lr: 1.9983e-04  eta: 1:40:05  time: 1.3788  data_time: 0.0067  memory: 6866  loss: 1.9819
03/17 11:07:18 - mmengine - INFO - Iter(train) [ 160/3117]  lr: 1.9977e-04  eta: 1:37:50  time: 1.4011  data_time: 0.0067  memory: 6866  loss: 2.0111
03/17 11:07:31 - mmengine - INFO - Iter(train) [ 170/3117]  lr: 1.9969e-04  eta: 1:35:38  time: 1.3373  data_time: 0.0065  memory: 6866  loss: 2.0955
03/17 11:07:44 - mmengine - INFO - Iter(train) [ 180/3117]  lr: 1.9960e-04  eta: 1:33:34  time: 1.3097  data_time: 0.0070  memory: 6866  loss: 2.0799
03/17 11:07:57 - mmengine - INFO - Iter(train) [ 190/3117]  lr: 1.9950e-04  eta: 1:31:39  time: 1.2851  data_time: 0.0067  memory: 6866  loss: 2.3525
03/17 11:08:10 - mmengine - INFO - Iter(train) [ 200/3117]  lr: 1.9939e-04  eta: 1:29:55  time: 1.2961  data_time: 0.0068  memory: 6866  loss: 1.8979
03/17 11:08:23 - mmengine - INFO - Iter(train) [ 210/3117]  lr: 1.9927e-04  eta: 1:28:23  time: 1.3156  data_time: 0.0067  memory: 6866  loss: 2.0957
03/17 11:08:37 - mmengine - INFO - Iter(train) [ 220/3117]  lr: 1.9914e-04  eta: 1:26:59  time: 1.3289  data_time: 0.0066  memory: 6866  loss: 2.1750
03/17 11:08:50 - mmengine - INFO - Iter(train) [ 230/3117]  lr: 1.9900e-04  eta: 1:25:46  time: 1.3631  data_time: 0.0069  memory: 6866  loss: 2.0782
03/17 11:09:04 - mmengine - INFO - Iter(train) [ 240/3117]  lr: 1.9885e-04  eta: 1:24:36  time: 1.3439  data_time: 0.0069  memory: 6866  loss: 2.0829
03/17 11:09:17 - mmengine - INFO - Iter(train) [ 250/3117]  lr: 1.9869e-04  eta: 1:23:26  time: 1.3087  data_time: 0.0072  memory: 6866  loss: 2.0431
03/17 11:09:30 - mmengine - INFO - Iter(train) [ 260/3117]  lr: 1.9852e-04  eta: 1:22:20  time: 1.3072  data_time: 0.0072  memory: 6866  loss: 1.8719
03/17 11:09:43 - mmengine - INFO - Iter(train) [ 270/3117]  lr: 1.9833e-04  eta: 1:21:20  time: 1.3217  data_time: 0.0068  memory: 6866  loss: 2.0205
03/17 11:09:56 - mmengine - INFO - Iter(train) [ 280/3117]  lr: 1.9814e-04  eta: 1:20:22  time: 1.3117  data_time: 0.0066  memory: 6866  loss: 1.7724
03/17 11:10:09 - mmengine - INFO - Iter(train) [ 290/3117]  lr: 1.9793e-04  eta: 1:19:27  time: 1.3074  data_time: 0.0070  memory: 6866  loss: 1.9696
03/17 11:10:23 - mmengine - INFO - Iter(train) [ 300/3117]  lr: 1.9772e-04  eta: 1:18:36  time: 1.3249  data_time: 0.0072  memory: 6866  loss: 1.9004
03/17 11:10:36 - mmengine - INFO - Iter(train) [ 310/3117]  lr: 1.9749e-04  eta: 1:17:47  time: 1.3223  data_time: 0.0076  memory: 6866  loss: 1.9182
03/17 11:10:49 - mmengine - INFO - Iter(train) [ 320/3117]  lr: 1.9726e-04  eta: 1:17:02  time: 1.3422  data_time: 0.0068  memory: 6866  loss: 2.2331
03/17 11:11:02 - mmengine - INFO - Iter(train) [ 330/3117]  lr: 1.9701e-04  eta: 1:16:16  time: 1.3031  data_time: 0.0064  memory: 6866  loss: 1.7793
03/17 11:11:15 - mmengine - INFO - Iter(train) [ 340/3117]  lr: 1.9675e-04  eta: 1:15:34  time: 1.3292  data_time: 0.0067  memory: 6866  loss: 1.8946
03/17 11:11:29 - mmengine - INFO - Iter(train) [ 350/3117]  lr: 1.9648e-04  eta: 1:14:55  time: 1.3428  data_time: 0.0077  memory: 6866  loss: 1.9591
03/17 11:11:42 - mmengine - INFO - Iter(train) [ 360/3117]  lr: 1.9621e-04  eta: 1:14:17  time: 1.3358  data_time: 0.0063  memory: 6866  loss: 2.0698
03/17 11:11:55 - mmengine - INFO - Iter(train) [ 370/3117]  lr: 1.9592e-04  eta: 1:13:39  time: 1.3211  data_time: 0.0063  memory: 6866  loss: 1.8544
03/17 11:12:09 - mmengine - INFO - Iter(train) [ 380/3117]  lr: 1.9562e-04  eta: 1:13:02  time: 1.3255  data_time: 0.0066  memory: 6866  loss: 1.7231
03/17 11:12:22 - mmengine - INFO - Iter(train) [ 390/3117]  lr: 1.9531e-04  eta: 1:12:26  time: 1.3164  data_time: 0.0087  memory: 6866  loss: 2.0388
03/17 11:12:35 - mmengine - INFO - Iter(train) [ 400/3117]  lr: 1.9499e-04  eta: 1:11:53  time: 1.3395  data_time: 0.0067  memory: 6866  loss: 1.9843
03/17 11:12:49 - mmengine - INFO - Iter(train) [ 410/3117]  lr: 1.9466e-04  eta: 1:11:20  time: 1.3339  data_time: 0.0067  memory: 6866  loss: 1.6795
03/17 11:13:02 - mmengine - INFO - Iter(train) [ 420/3117]  lr: 1.9432e-04  eta: 1:10:48  time: 1.3222  data_time: 0.0065  memory: 6866  loss: 1.9311
03/17 11:13:15 - mmengine - INFO - Iter(train) [ 430/3117]  lr: 1.9397e-04  eta: 1:10:16  time: 1.3218  data_time: 0.0066  memory: 6866  loss: 1.8559
03/17 11:13:29 - mmengine - INFO - Iter(train) [ 440/3117]  lr: 1.9361e-04  eta: 1:09:47  time: 1.3470  data_time: 0.0066  memory: 6866  loss: 2.2676
03/17 11:13:42 - mmengine - INFO - Iter(train) [ 450/3117]  lr: 1.9324e-04  eta: 1:09:19  time: 1.3586  data_time: 0.0063  memory: 6866  loss: 1.8986
03/17 11:13:56 - mmengine - INFO - Iter(train) [ 460/3117]  lr: 1.9286e-04  eta: 1:08:52  time: 1.3576  data_time: 0.0068  memory: 6866  loss: 1.8331
03/17 11:14:09 - mmengine - INFO - Iter(train) [ 470/3117]  lr: 1.9247e-04  eta: 1:08:26  time: 1.3702  data_time: 0.0067  memory: 6866  loss: 1.8537
03/17 11:14:23 - mmengine - INFO - Iter(train) [ 480/3117]  lr: 1.9207e-04  eta: 1:08:03  time: 1.4087  data_time: 0.0064  memory: 6866  loss: 2.0129
03/17 11:14:38 - mmengine - INFO - Iter(train) [ 490/3117]  lr: 1.9166e-04  eta: 1:07:40  time: 1.4072  data_time: 0.0064  memory: 6866  loss: 1.9917
03/17 11:14:52 - mmengine - INFO - Iter(train) [ 500/3117]  lr: 1.9124e-04  eta: 1:07:18  time: 1.4337  data_time: 0.0063  memory: 6866  loss: 1.8935
03/17 11:14:52 - mmengine - INFO - after_train_iter in EvaluateChatHook.
03/17 11:14:54 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
你是谁呀<|im_end|>
<|im_start|>assistant
我是人工智能助手，名叫小智。我是一个程序，旨在帮助您解决问题和提供信息。我可以通过回答问题、提供建议和执行任务来帮助您。如果您有任何问题或需要帮助，请随时告诉我。<|im_end|>

03/17 11:14:58 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
我又是谁呢<|im_end|>
<|im_start|>assistant
你啊，就是那个在茫茫人海中寻找自己的旅人。你或许是一个孤独的人，或许是一个追求自由的人，或许是一个渴望被理解的人。无论你是谁，你都有权利去追求自己的梦想和幸福。不要害怕面对自己的内心，勇敢地面对自己的过去和未来。相信自己，相信自己的能力，你一定能够找到属于自己的道路。<|im_end|>

03/17 11:15:03 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
书生浦语是谁<|im_end|>
<|im_start|>assistant
书生浦语是《红楼梦》中的人物，是贾宝玉的侍女。她聪明伶俐，机智过人，善于观察和分析，对贾宝玉的命运有着深刻的理解。书生浦语在《红楼梦》中扮演着重要的角色，她与贾宝玉之间的感情纠葛，以及她对贾宝玉的忠诚和支持，都为整个故事增添了情感的深度。<|im_end|>

03/17 11:15:05 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
上海人工智能实验室是哪的<|im_end|>
<|im_start|>assistant
对不起，我无法回答您的问题。若有其他需要帮助的问题，欢迎随时向我提问，我会在我能力范围内尽力为你解答。<|im_end|>

03/17 11:15:05 - mmengine - INFO - Saving checkpoint at 500 iterations
[2024-03-17 11:15:05,849] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint iter_500.pth is about to be saved!
/root/.local/lib/python3.10/site-packages/torch/nn/modules/module.py:1877: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-03-17 11:15:05,900] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_500.pth/mp_rank_00_model_states.pt
[2024-03-17 11:15:05,900] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_500.pth/mp_rank_00_model_states.pt...
[2024-03-17 11:15:06,022] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_500.pth/mp_rank_00_model_states.pt.
[2024-03-17 11:15:06,025] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_500.pth/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-03-17 11:15:06,636] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_500.pth/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-03-17 11:15:06,671] [INFO] [engine.py:3477:_save_zero_checkpoint] zero checkpoint saved /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_500.pth/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-03-17 11:15:06,671] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint iter_500.pth is ready now!
/root/.local/lib/python3.10/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/root/.local/lib/python3.10/site-packages/torch/autograd/__init__.py:266: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
03/17 11:15:22 - mmengine - INFO - Iter(train) [ 510/3117]  lr: 1.9081e-04  eta: 1:08:19  time: 3.0283  data_time: 1.4354  memory: 6866  loss: 1.9133
03/17 11:15:38 - mmengine - INFO - Iter(train) [ 520/3117]  lr: 1.9037e-04  eta: 1:08:02  time: 1.5611  data_time: 0.0092  memory: 6866  loss: 1.7737
03/17 11:15:53 - mmengine - INFO - Iter(train) [ 530/3117]  lr: 1.8992e-04  eta: 1:07:44  time: 1.5228  data_time: 0.0070  memory: 6866  loss: 2.0373
03/17 11:16:08 - mmengine - INFO - Iter(train) [ 540/3117]  lr: 1.8946e-04  eta: 1:07:26  time: 1.5129  data_time: 0.0068  memory: 6866  loss: 1.8810
03/17 11:16:23 - mmengine - INFO - Iter(train) [ 550/3117]  lr: 1.8899e-04  eta: 1:07:08  time: 1.5259  data_time: 0.0069  memory: 6866  loss: 1.8629
03/17 11:16:39 - mmengine - INFO - Iter(train) [ 560/3117]  lr: 1.8851e-04  eta: 1:06:50  time: 1.5231  data_time: 0.0068  memory: 6866  loss: 1.9816
03/17 11:16:53 - mmengine - INFO - Iter(train) [ 570/3117]  lr: 1.8802e-04  eta: 1:06:30  time: 1.4698  data_time: 0.0096  memory: 6866  loss: 1.6960
03/17 11:17:08 - mmengine - INFO - Iter(train) [ 580/3117]  lr: 1.8752e-04  eta: 1:06:10  time: 1.4591  data_time: 0.0083  memory: 6866  loss: 2.0017
03/17 11:17:22 - mmengine - INFO - Iter(train) [ 590/3117]  lr: 1.8702e-04  eta: 1:05:48  time: 1.4144  data_time: 0.0068  memory: 6866  loss: 1.8050
03/17 11:17:36 - mmengine - INFO - Iter(train) [ 600/3117]  lr: 1.8650e-04  eta: 1:05:25  time: 1.3927  data_time: 0.0068  memory: 6866  loss: 1.9787
03/17 11:17:50 - mmengine - INFO - Iter(train) [ 610/3117]  lr: 1.8597e-04  eta: 1:05:01  time: 1.3539  data_time: 0.0069  memory: 6866  loss: 1.9015
03/17 11:18:03 - mmengine - INFO - Iter(train) [ 620/3117]  lr: 1.8544e-04  eta: 1:04:37  time: 1.3500  data_time: 0.0068  memory: 6866  loss: 1.9129
03/17 11:18:17 - mmengine - INFO - Iter(train) [ 630/3117]  lr: 1.8489e-04  eta: 1:04:14  time: 1.3532  data_time: 0.0070  memory: 6866  loss: 1.8998
03/17 11:18:30 - mmengine - INFO - Iter(train) [ 640/3117]  lr: 1.8434e-04  eta: 1:03:52  time: 1.3931  data_time: 0.0066  memory: 6866  loss: 2.0036
03/17 11:18:44 - mmengine - INFO - Iter(train) [ 650/3117]  lr: 1.8378e-04  eta: 1:03:30  time: 1.3807  data_time: 0.0085  memory: 6866  loss: 1.7856
03/17 11:18:58 - mmengine - INFO - Iter(train) [ 660/3117]  lr: 1.8320e-04  eta: 1:03:08  time: 1.3637  data_time: 0.0069  memory: 6866  loss: 1.8344
03/17 11:19:12 - mmengine - INFO - Iter(train) [ 670/3117]  lr: 1.8262e-04  eta: 1:02:46  time: 1.3564  data_time: 0.0063  memory: 6866  loss: 1.7311
03/17 11:19:25 - mmengine - INFO - Iter(train) [ 680/3117]  lr: 1.8203e-04  eta: 1:02:24  time: 1.3667  data_time: 0.0066  memory: 6866  loss: 1.9476
03/17 11:19:39 - mmengine - INFO - Iter(train) [ 690/3117]  lr: 1.8144e-04  eta: 1:02:04  time: 1.3824  data_time: 0.0080  memory: 6866  loss: 1.5130
03/17 11:19:53 - mmengine - INFO - Iter(train) [ 700/3117]  lr: 1.8083e-04  eta: 1:01:43  time: 1.3749  data_time: 0.0063  memory: 6866  loss: 2.0036
03/17 11:20:07 - mmengine - INFO - Iter(train) [ 710/3117]  lr: 1.8021e-04  eta: 1:01:23  time: 1.3962  data_time: 0.0066  memory: 6866  loss: 1.6509
03/17 11:20:21 - mmengine - INFO - Iter(train) [ 720/3117]  lr: 1.7959e-04  eta: 1:01:03  time: 1.3816  data_time: 0.0072  memory: 6866  loss: 1.8492
03/17 11:20:34 - mmengine - INFO - Iter(train) [ 730/3117]  lr: 1.7895e-04  eta: 1:00:42  time: 1.3738  data_time: 0.0118  memory: 6866  loss: 1.9330
03/17 11:20:48 - mmengine - INFO - Iter(train) [ 740/3117]  lr: 1.7831e-04  eta: 1:00:23  time: 1.3944  data_time: 0.0069  memory: 6866  loss: 1.8801
03/17 11:21:02 - mmengine - INFO - Iter(train) [ 750/3117]  lr: 1.7766e-04  eta: 1:00:03  time: 1.3742  data_time: 0.0068  memory: 6866  loss: 1.8223
03/17 11:21:16 - mmengine - INFO - Iter(train) [ 760/3117]  lr: 1.7700e-04  eta: 0:59:42  time: 1.3565  data_time: 0.0071  memory: 6866  loss: 1.8084
03/17 11:21:29 - mmengine - INFO - Iter(train) [ 770/3117]  lr: 1.7634e-04  eta: 0:59:21  time: 1.3244  data_time: 0.0076  memory: 6866  loss: 1.6625
03/17 11:21:43 - mmengine - INFO - Iter(train) [ 780/3117]  lr: 1.7566e-04  eta: 0:59:02  time: 1.3765  data_time: 0.0067  memory: 6866  loss: 1.8185
03/17 11:21:57 - mmengine - INFO - Iter(train) [ 790/3117]  lr: 1.7498e-04  eta: 0:58:44  time: 1.4269  data_time: 0.0073  memory: 6866  loss: 1.8852
03/17 11:22:11 - mmengine - INFO - Iter(train) [ 800/3117]  lr: 1.7429e-04  eta: 0:58:25  time: 1.3787  data_time: 0.0089  memory: 6866  loss: 1.6823
03/17 11:22:24 - mmengine - INFO - Iter(train) [ 810/3117]  lr: 1.7359e-04  eta: 0:58:06  time: 1.3630  data_time: 0.0069  memory: 6866  loss: 1.6292
03/17 11:22:38 - mmengine - INFO - Iter(train) [ 820/3117]  lr: 1.7288e-04  eta: 0:57:48  time: 1.4106  data_time: 0.0065  memory: 6866  loss: 1.6686
03/17 11:22:52 - mmengine - INFO - Iter(train) [ 830/3117]  lr: 1.7216e-04  eta: 0:57:30  time: 1.4144  data_time: 0.0063  memory: 6866  loss: 1.8159
03/17 11:23:07 - mmengine - INFO - Iter(train) [ 840/3117]  lr: 1.7144e-04  eta: 0:57:13  time: 1.4298  data_time: 0.0071  memory: 6866  loss: 1.7287
03/17 11:23:21 - mmengine - INFO - Iter(train) [ 850/3117]  lr: 1.7071e-04  eta: 0:56:56  time: 1.4424  data_time: 0.0066  memory: 6866  loss: 1.8205
03/17 11:23:36 - mmengine - INFO - Iter(train) [ 860/3117]  lr: 1.6997e-04  eta: 0:56:39  time: 1.4552  data_time: 0.0061  memory: 6866  loss: 1.6069
03/17 11:23:50 - mmengine - INFO - Iter(train) [ 870/3117]  lr: 1.6923e-04  eta: 0:56:23  time: 1.4466  data_time: 0.0066  memory: 6866  loss: 1.8016
03/17 11:24:05 - mmengine - INFO - Iter(train) [ 880/3117]  lr: 1.6847e-04  eta: 0:56:07  time: 1.4739  data_time: 0.0065  memory: 6866  loss: 1.7892
03/17 11:24:19 - mmengine - INFO - Iter(train) [ 890/3117]  lr: 1.6771e-04  eta: 0:55:50  time: 1.4153  data_time: 0.0062  memory: 6866  loss: 1.5693
03/17 11:24:33 - mmengine - INFO - Iter(train) [ 900/3117]  lr: 1.6694e-04  eta: 0:55:31  time: 1.3771  data_time: 0.0063  memory: 6866  loss: 1.9246
03/17 11:24:46 - mmengine - INFO - Iter(train) [ 910/3117]  lr: 1.6617e-04  eta: 0:55:13  time: 1.3543  data_time: 0.0063  memory: 6866  loss: 2.0239
03/17 11:25:00 - mmengine - INFO - Iter(train) [ 920/3117]  lr: 1.6539e-04  eta: 0:54:54  time: 1.3481  data_time: 0.0064  memory: 6866  loss: 1.8551
03/17 11:25:14 - mmengine - INFO - Iter(train) [ 930/3117]  lr: 1.6460e-04  eta: 0:54:36  time: 1.3706  data_time: 0.0066  memory: 6866  loss: 1.7659
03/17 11:25:27 - mmengine - INFO - Iter(train) [ 940/3117]  lr: 1.6380e-04  eta: 0:54:18  time: 1.3535  data_time: 0.0063  memory: 6866  loss: 1.6765
03/17 11:25:41 - mmengine - INFO - Iter(train) [ 950/3117]  lr: 1.6300e-04  eta: 0:53:59  time: 1.3481  data_time: 0.0065  memory: 6866  loss: 1.7194
03/17 11:25:54 - mmengine - INFO - Iter(train) [ 960/3117]  lr: 1.6219e-04  eta: 0:53:41  time: 1.3365  data_time: 0.0065  memory: 6866  loss: 1.6535
03/17 11:26:07 - mmengine - INFO - Iter(train) [ 970/3117]  lr: 1.6137e-04  eta: 0:53:22  time: 1.3157  data_time: 0.0066  memory: 6866  loss: 1.9087
03/17 11:26:20 - mmengine - INFO - Iter(train) [ 980/3117]  lr: 1.6055e-04  eta: 0:53:03  time: 1.2987  data_time: 0.0068  memory: 6866  loss: 1.6808
03/17 11:26:33 - mmengine - INFO - Iter(train) [ 990/3117]  lr: 1.5972e-04  eta: 0:52:43  time: 1.2558  data_time: 0.0065  memory: 6866  loss: 1.7975
03/17 11:26:46 - mmengine - INFO - Exp name: xiyou_1_8b_20240317_110043
03/17 11:26:46 - mmengine - INFO - Iter(train) [1000/3117]  lr: 1.5888e-04  eta: 0:52:24  time: 1.2833  data_time: 0.0062  memory: 6866  loss: 1.7558
03/17 11:26:46 - mmengine - INFO - after_train_iter in EvaluateChatHook.
03/17 11:26:47 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
你是谁呀<|im_end|>
<|im_start|>assistant
我是人工智能助手，名叫小智。我是专门为人类提供帮助和服务的。请问有什么我可以帮助您的吗？<|im_end|>

03/17 11:26:52 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
我又是谁呢<|im_end|>
<|im_start|>assistant
贫僧乃是菩提祖师，乃是佛门弟子，修行者。贫僧自小修行，悟道成佛，得道成仙，乃是佛门中的大德高僧。贫僧虽是凡胎，却心存善念，行善积德，以普渡众生为己任，愿以佛法普渡众生，助人为乐，助人为善。愿一切众生皆能离苦得乐，超凡脱俗，得道成仙。<|im_end|>

03/17 11:27:02 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
书生浦语是谁<|im_end|>
<|im_start|>assistant
书生浦语是《魔戒》系列小说中的虚构人物，由英国作家J.R.R. Tolkien所创造。她是《魔戒》系列中的女主人公，也是《魔戒》系列中的重要角色。书生浦语是一个聪明、勇敢、善良的年轻女子，她与霍比特人比尔博·巴金斯一起，在霍比特人前往中土世界寻找魔戒的过程中，经历了许多冒险和困难。书生浦语的性格特点包括勇敢、聪明、善良和坚韧不拔，她用自己的智慧和勇气，帮助了霍比特人和其他角色，最终成功完成了任务。书生浦语是《魔戒》系列中的重要角色，也是J.R.R. Tolkien所创造的众多虚构人物之一。<|im_end|>

03/17 11:27:03 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
上海人工智能实验室是哪的<|im_end|>
<|im_start|>assistant
对不起，我无法回答您的问题。如果您有其他问题，欢迎随时向我提问。<|im_end|>

03/17 11:27:03 - mmengine - INFO - Saving checkpoint at 1000 iterations
[2024-03-17 11:27:03,277] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint iter_1000.pth is about to be saved!
/root/.local/lib/python3.10/site-packages/torch/nn/modules/module.py:1877: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-03-17 11:27:03,310] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_1000.pth/mp_rank_00_model_states.pt
[2024-03-17 11:27:03,310] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_1000.pth/mp_rank_00_model_states.pt...
[2024-03-17 11:27:03,419] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_1000.pth/mp_rank_00_model_states.pt.
[2024-03-17 11:27:03,430] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_1000.pth/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-03-17 11:27:04,060] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_1000.pth/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-03-17 11:27:04,092] [INFO] [engine.py:3477:_save_zero_checkpoint] zero checkpoint saved /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_1000.pth/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-03-17 11:27:04,092] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint iter_1000.pth is ready now!
/root/.local/lib/python3.10/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/root/.local/lib/python3.10/site-packages/torch/autograd/__init__.py:266: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
03/17 11:27:19 - mmengine - INFO - Iter(train) [1010/3117]  lr: 1.5804e-04  eta: 0:52:47  time: 3.3011  data_time: 1.8151  memory: 6866  loss: 1.8919
03/17 11:27:33 - mmengine - INFO - Iter(train) [1020/3117]  lr: 1.5719e-04  eta: 0:52:31  time: 1.4716  data_time: 0.0078  memory: 6866  loss: 1.7159
03/17 11:27:48 - mmengine - INFO - Iter(train) [1030/3117]  lr: 1.5633e-04  eta: 0:52:15  time: 1.4519  data_time: 0.0065  memory: 6866  loss: 1.7012
03/17 11:28:00 - mmengine - INFO - Exp name: xiyou_1_8b_20240317_110043
03/17 11:28:00 - mmengine - WARNING - Reach the end of the dataloader, it will be restarted and continue to iterate. It is recommended to use `mmengine.dataset.InfiniteSampler` to enable the dataloader to iterate infinitely.
03/17 11:28:04 - mmengine - INFO - Iter(train) [1040/3117]  lr: 1.5547e-04  eta: 0:52:02  time: 1.6145  data_time: 0.2068  memory: 6866  loss: 1.8076
03/17 11:28:18 - mmengine - INFO - Iter(train) [1050/3117]  lr: 1.5460e-04  eta: 0:51:46  time: 1.4238  data_time: 0.0066  memory: 6866  loss: 1.6838
03/17 11:28:32 - mmengine - INFO - Iter(train) [1060/3117]  lr: 1.5373e-04  eta: 0:51:29  time: 1.4358  data_time: 0.0090  memory: 6866  loss: 1.7419
03/17 11:28:47 - mmengine - INFO - Iter(train) [1070/3117]  lr: 1.5285e-04  eta: 0:51:13  time: 1.4289  data_time: 0.0066  memory: 6866  loss: 1.7838
03/17 11:29:01 - mmengine - INFO - Iter(train) [1080/3117]  lr: 1.5197e-04  eta: 0:50:56  time: 1.4025  data_time: 0.0087  memory: 6866  loss: 1.5719
03/17 11:29:15 - mmengine - INFO - Iter(train) [1090/3117]  lr: 1.5108e-04  eta: 0:50:39  time: 1.3883  data_time: 0.0067  memory: 6866  loss: 1.6214
03/17 11:29:28 - mmengine - INFO - Iter(train) [1100/3117]  lr: 1.5018e-04  eta: 0:50:21  time: 1.3449  data_time: 0.0077  memory: 6866  loss: 1.7080
03/17 11:29:41 - mmengine - INFO - Iter(train) [1110/3117]  lr: 1.4928e-04  eta: 0:50:03  time: 1.3224  data_time: 0.0064  memory: 6866  loss: 1.6778
03/17 11:29:55 - mmengine - INFO - Iter(train) [1120/3117]  lr: 1.4837e-04  eta: 0:49:45  time: 1.3495  data_time: 0.0062  memory: 6866  loss: 1.7385
03/17 11:30:11 - mmengine - INFO - Iter(train) [1130/3117]  lr: 1.4746e-04  eta: 0:49:33  time: 1.6127  data_time: 0.0072  memory: 6866  loss: 1.6376
03/17 11:30:25 - mmengine - INFO - Iter(train) [1140/3117]  lr: 1.4654e-04  eta: 0:49:15  time: 1.3549  data_time: 0.0091  memory: 6866  loss: 1.8095
03/17 11:30:38 - mmengine - INFO - Iter(train) [1150/3117]  lr: 1.4562e-04  eta: 0:48:58  time: 1.3458  data_time: 0.0069  memory: 6866  loss: 1.6573
03/17 11:30:51 - mmengine - INFO - Iter(train) [1160/3117]  lr: 1.4469e-04  eta: 0:48:40  time: 1.3369  data_time: 0.0077  memory: 6866  loss: 1.6293
03/17 11:31:05 - mmengine - INFO - Iter(train) [1170/3117]  lr: 1.4376e-04  eta: 0:48:23  time: 1.3451  data_time: 0.0083  memory: 6866  loss: 1.6750
03/17 11:31:19 - mmengine - INFO - Iter(train) [1180/3117]  lr: 1.4283e-04  eta: 0:48:06  time: 1.3729  data_time: 0.0120  memory: 6866  loss: 1.6739
03/17 11:31:33 - mmengine - INFO - Iter(train) [1190/3117]  lr: 1.4188e-04  eta: 0:47:50  time: 1.4071  data_time: 0.0066  memory: 6866  loss: 1.6700
03/17 11:31:46 - mmengine - INFO - Iter(train) [1200/3117]  lr: 1.4094e-04  eta: 0:47:33  time: 1.3677  data_time: 0.0067  memory: 6866  loss: 1.6335
03/17 11:32:00 - mmengine - INFO - Iter(train) [1210/3117]  lr: 1.3999e-04  eta: 0:47:16  time: 1.3947  data_time: 0.0096  memory: 6866  loss: 1.7380
03/17 11:32:14 - mmengine - INFO - Iter(train) [1220/3117]  lr: 1.3903e-04  eta: 0:47:00  time: 1.3866  data_time: 0.0063  memory: 6866  loss: 1.6932
03/17 11:32:28 - mmengine - INFO - Iter(train) [1230/3117]  lr: 1.3808e-04  eta: 0:46:44  time: 1.4218  data_time: 0.0069  memory: 6866  loss: 1.6018
03/17 11:32:43 - mmengine - INFO - Iter(train) [1240/3117]  lr: 1.3711e-04  eta: 0:46:28  time: 1.4366  data_time: 0.0067  memory: 6866  loss: 1.7502
03/17 11:32:57 - mmengine - INFO - Iter(train) [1250/3117]  lr: 1.3615e-04  eta: 0:46:13  time: 1.4590  data_time: 0.0063  memory: 6866  loss: 1.7101
03/17 11:33:12 - mmengine - INFO - Iter(train) [1260/3117]  lr: 1.3518e-04  eta: 0:45:58  time: 1.4337  data_time: 0.0099  memory: 6866  loss: 1.6907
03/17 11:33:26 - mmengine - INFO - Iter(train) [1270/3117]  lr: 1.3420e-04  eta: 0:45:42  time: 1.4597  data_time: 0.0082  memory: 6866  loss: 1.6111
03/17 11:33:41 - mmengine - INFO - Iter(train) [1280/3117]  lr: 1.3322e-04  eta: 0:45:27  time: 1.4646  data_time: 0.0065  memory: 6866  loss: 1.8026
03/17 11:33:55 - mmengine - INFO - Iter(train) [1290/3117]  lr: 1.3224e-04  eta: 0:45:12  time: 1.4507  data_time: 0.0093  memory: 6866  loss: 1.5758
03/17 11:34:10 - mmengine - INFO - Iter(train) [1300/3117]  lr: 1.3126e-04  eta: 0:44:57  time: 1.4624  data_time: 0.0068  memory: 6866  loss: 1.7315
03/17 11:34:24 - mmengine - INFO - Iter(train) [1310/3117]  lr: 1.3027e-04  eta: 0:44:41  time: 1.4404  data_time: 0.0116  memory: 6866  loss: 1.6381
03/17 11:34:39 - mmengine - INFO - Iter(train) [1320/3117]  lr: 1.2928e-04  eta: 0:44:26  time: 1.4354  data_time: 0.0066  memory: 6866  loss: 1.7261
03/17 11:34:53 - mmengine - INFO - Iter(train) [1330/3117]  lr: 1.2828e-04  eta: 0:44:10  time: 1.4525  data_time: 0.0089  memory: 6866  loss: 1.7517
03/17 11:35:08 - mmengine - INFO - Iter(train) [1340/3117]  lr: 1.2728e-04  eta: 0:43:55  time: 1.4379  data_time: 0.0062  memory: 6866  loss: 1.7266
03/17 11:35:22 - mmengine - INFO - Iter(train) [1350/3117]  lr: 1.2628e-04  eta: 0:43:39  time: 1.4058  data_time: 0.0099  memory: 6866  loss: 1.7271
03/17 11:35:35 - mmengine - INFO - Iter(train) [1360/3117]  lr: 1.2528e-04  eta: 0:43:23  time: 1.3765  data_time: 0.0065  memory: 6866  loss: 1.7395
03/17 11:35:49 - mmengine - INFO - Iter(train) [1370/3117]  lr: 1.2427e-04  eta: 0:43:07  time: 1.3629  data_time: 0.0074  memory: 6866  loss: 1.7302
03/17 11:36:03 - mmengine - INFO - Iter(train) [1380/3117]  lr: 1.2326e-04  eta: 0:42:50  time: 1.3674  data_time: 0.0070  memory: 6866  loss: 1.7065
03/17 11:36:16 - mmengine - INFO - Iter(train) [1390/3117]  lr: 1.2225e-04  eta: 0:42:34  time: 1.3482  data_time: 0.0092  memory: 6866  loss: 1.7583
03/17 11:36:30 - mmengine - INFO - Iter(train) [1400/3117]  lr: 1.2124e-04  eta: 0:42:18  time: 1.3733  data_time: 0.0065  memory: 6866  loss: 1.6034
03/17 11:36:44 - mmengine - INFO - Iter(train) [1410/3117]  lr: 1.2022e-04  eta: 0:42:02  time: 1.3709  data_time: 0.0086  memory: 6866  loss: 1.6325
03/17 11:36:57 - mmengine - INFO - Iter(train) [1420/3117]  lr: 1.1920e-04  eta: 0:41:46  time: 1.3726  data_time: 0.0065  memory: 6866  loss: 1.6404
03/17 11:37:11 - mmengine - INFO - Iter(train) [1430/3117]  lr: 1.1818e-04  eta: 0:41:30  time: 1.3644  data_time: 0.0063  memory: 6866  loss: 1.7993
03/17 11:37:24 - mmengine - INFO - Iter(train) [1440/3117]  lr: 1.1716e-04  eta: 0:41:13  time: 1.3182  data_time: 0.0065  memory: 6866  loss: 1.6657
03/17 11:37:37 - mmengine - INFO - Iter(train) [1450/3117]  lr: 1.1614e-04  eta: 0:40:56  time: 1.2772  data_time: 0.0066  memory: 6866  loss: 1.6073
03/17 11:37:50 - mmengine - INFO - Iter(train) [1460/3117]  lr: 1.1511e-04  eta: 0:40:39  time: 1.2860  data_time: 0.0063  memory: 6866  loss: 1.9063
03/17 11:38:03 - mmengine - INFO - Iter(train) [1470/3117]  lr: 1.1408e-04  eta: 0:40:22  time: 1.2830  data_time: 0.0066  memory: 6866  loss: 1.5759
03/17 11:38:16 - mmengine - INFO - Iter(train) [1480/3117]  lr: 1.1305e-04  eta: 0:40:06  time: 1.2933  data_time: 0.0064  memory: 6866  loss: 1.5730
03/17 11:38:28 - mmengine - INFO - Iter(train) [1490/3117]  lr: 1.1202e-04  eta: 0:39:49  time: 1.2769  data_time: 0.0066  memory: 6866  loss: 1.4487
03/17 11:38:41 - mmengine - INFO - Iter(train) [1500/3117]  lr: 1.1099e-04  eta: 0:39:32  time: 1.2705  data_time: 0.0064  memory: 6866  loss: 1.6021
03/17 11:38:41 - mmengine - INFO - after_train_iter in EvaluateChatHook.
03/17 11:38:46 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
你是谁呀<|im_end|>
<|im_start|>assistant
贫僧乃是唐朝僧人，名为普救禅师。贫僧修行多年，悟道成佛，已得正果。贫僧虽非尘世之人，却对佛法有着深厚的信仰和研究。贫僧愿以普渡众生为己任，助人超脱生死轮回，追求解脱之道。愿众生皆能悟道成佛，离苦得乐。<|im_end|>

03/17 11:38:50 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
我又是谁呢<|im_end|>
<|im_start|>assistant
贫僧乃是东土大唐的僧人，奉旨前往西天取经，以期普渡众生，弘扬佛法。贫僧虽非尘世之人，却心怀慈悲，愿以佛法普渡众生，助人超脱生死轮回，获得解脱。愿众生皆能修行善行，超脱生死，获得真正的幸福与安宁。<|im_end|>

03/17 11:38:54 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
书生浦语是谁<|im_end|>
<|im_start|>assistant
书生浦语是《西游记》中的角色，是唐僧的徒弟之一，也是孙悟空的师弟。她聪明机智，勇敢无畏，擅长使用武器，擅长变化，是唐僧的得力助手。书生浦语在《西游记》中扮演着重要的角色，帮助唐僧师徒们克服各种困难，保护师傅的安全。<|im_end|>

03/17 11:38:55 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
上海人工智能实验室是哪的<|im_end|>
<|im_start|>assistant
对不起，我无法回答您的问题。如果您有其他问题，欢迎随时向我提问。<|im_end|>

03/17 11:38:55 - mmengine - INFO - Saving checkpoint at 1500 iterations
[2024-03-17 11:38:55,781] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint iter_1500.pth is about to be saved!
/root/.local/lib/python3.10/site-packages/torch/nn/modules/module.py:1877: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-03-17 11:38:55,850] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_1500.pth/mp_rank_00_model_states.pt
[2024-03-17 11:38:55,850] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_1500.pth/mp_rank_00_model_states.pt...
[2024-03-17 11:38:55,954] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_1500.pth/mp_rank_00_model_states.pt.
[2024-03-17 11:38:55,957] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_1500.pth/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-03-17 11:38:56,544] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_1500.pth/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-03-17 11:38:56,575] [INFO] [engine.py:3477:_save_zero_checkpoint] zero checkpoint saved /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_1500.pth/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-03-17 11:38:56,575] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint iter_1500.pth is ready now!
/root/.local/lib/python3.10/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/root/.local/lib/python3.10/site-packages/torch/autograd/__init__.py:266: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
03/17 11:39:11 - mmengine - INFO - Iter(train) [1510/3117]  lr: 1.0996e-04  eta: 0:39:33  time: 2.9462  data_time: 1.5016  memory: 6866  loss: 1.5340
03/17 11:39:25 - mmengine - INFO - Iter(train) [1520/3117]  lr: 1.0892e-04  eta: 0:39:18  time: 1.4772  data_time: 0.0067  memory: 6866  loss: 1.7229
03/17 11:39:40 - mmengine - INFO - Iter(train) [1530/3117]  lr: 1.0789e-04  eta: 0:39:04  time: 1.4753  data_time: 0.0078  memory: 6866  loss: 1.6451
03/17 11:39:55 - mmengine - INFO - Iter(train) [1540/3117]  lr: 1.0685e-04  eta: 0:38:49  time: 1.4706  data_time: 0.0067  memory: 6866  loss: 1.6657
03/17 11:40:09 - mmengine - INFO - Iter(train) [1550/3117]  lr: 1.0581e-04  eta: 0:38:33  time: 1.4270  data_time: 0.0065  memory: 6866  loss: 1.5646
03/17 11:40:23 - mmengine - INFO - Iter(train) [1560/3117]  lr: 1.0478e-04  eta: 0:38:18  time: 1.4063  data_time: 0.0065  memory: 6866  loss: 1.6585
03/17 11:40:37 - mmengine - INFO - Iter(train) [1570/3117]  lr: 1.0374e-04  eta: 0:38:02  time: 1.3711  data_time: 0.0071  memory: 6866  loss: 1.7311
03/17 11:40:51 - mmengine - INFO - Iter(train) [1580/3117]  lr: 1.0270e-04  eta: 0:37:47  time: 1.3976  data_time: 0.0064  memory: 6866  loss: 1.6469
03/17 11:41:05 - mmengine - INFO - Iter(train) [1590/3117]  lr: 1.0166e-04  eta: 0:37:32  time: 1.4378  data_time: 0.0084  memory: 6866  loss: 1.7047
03/17 11:41:20 - mmengine - INFO - Iter(train) [1600/3117]  lr: 1.0062e-04  eta: 0:37:17  time: 1.4844  data_time: 0.0067  memory: 6866  loss: 1.6838
03/17 11:41:35 - mmengine - INFO - Iter(train) [1610/3117]  lr: 9.9584e-05  eta: 0:37:02  time: 1.4597  data_time: 0.0066  memory: 6866  loss: 1.5193
03/17 11:41:49 - mmengine - INFO - Iter(train) [1620/3117]  lr: 9.8546e-05  eta: 0:36:47  time: 1.4763  data_time: 0.0064  memory: 6866  loss: 1.7598
03/17 11:42:04 - mmengine - INFO - Iter(train) [1630/3117]  lr: 9.7507e-05  eta: 0:36:32  time: 1.4414  data_time: 0.0062  memory: 6866  loss: 1.5565
03/17 11:42:18 - mmengine - INFO - Iter(train) [1640/3117]  lr: 9.6469e-05  eta: 0:36:17  time: 1.4364  data_time: 0.0063  memory: 6866  loss: 1.7968
03/17 11:42:33 - mmengine - INFO - Iter(train) [1650/3117]  lr: 9.5430e-05  eta: 0:36:02  time: 1.4312  data_time: 0.0070  memory: 6866  loss: 1.7181
03/17 11:42:47 - mmengine - INFO - Iter(train) [1660/3117]  lr: 9.4393e-05  eta: 0:35:47  time: 1.4098  data_time: 0.0067  memory: 6866  loss: 1.5658
03/17 11:43:01 - mmengine - INFO - Iter(train) [1670/3117]  lr: 9.3356e-05  eta: 0:35:31  time: 1.4127  data_time: 0.0062  memory: 6866  loss: 1.5418
03/17 11:43:15 - mmengine - INFO - Iter(train) [1680/3117]  lr: 9.2320e-05  eta: 0:35:16  time: 1.4064  data_time: 0.0065  memory: 6866  loss: 1.5997
03/17 11:43:29 - mmengine - INFO - Iter(train) [1690/3117]  lr: 9.1284e-05  eta: 0:35:01  time: 1.3842  data_time: 0.0066  memory: 6866  loss: 1.5891
03/17 11:43:42 - mmengine - INFO - Iter(train) [1700/3117]  lr: 9.0250e-05  eta: 0:34:45  time: 1.3755  data_time: 0.0062  memory: 6866  loss: 1.7047
03/17 11:43:56 - mmengine - INFO - Iter(train) [1710/3117]  lr: 8.9217e-05  eta: 0:34:29  time: 1.3286  data_time: 0.0065  memory: 6866  loss: 1.4760
03/17 11:44:09 - mmengine - INFO - Iter(train) [1720/3117]  lr: 8.8184e-05  eta: 0:34:13  time: 1.3352  data_time: 0.0064  memory: 6866  loss: 1.6115
03/17 11:44:23 - mmengine - INFO - Iter(train) [1730/3117]  lr: 8.7153e-05  eta: 0:33:58  time: 1.3665  data_time: 0.0065  memory: 6866  loss: 1.8192
03/17 11:44:36 - mmengine - INFO - Iter(train) [1740/3117]  lr: 8.6124e-05  eta: 0:33:42  time: 1.3299  data_time: 0.0068  memory: 6866  loss: 1.5724
03/17 11:44:50 - mmengine - INFO - Iter(train) [1750/3117]  lr: 8.5096e-05  eta: 0:33:27  time: 1.3714  data_time: 0.0069  memory: 6866  loss: 1.6145
03/17 11:45:04 - mmengine - INFO - Iter(train) [1760/3117]  lr: 8.4069e-05  eta: 0:33:11  time: 1.4114  data_time: 0.0098  memory: 6866  loss: 1.7107
03/17 11:45:18 - mmengine - INFO - Iter(train) [1770/3117]  lr: 8.3045e-05  eta: 0:32:56  time: 1.3981  data_time: 0.0087  memory: 6866  loss: 1.7688
03/17 11:45:32 - mmengine - INFO - Iter(train) [1780/3117]  lr: 8.2022e-05  eta: 0:32:41  time: 1.3838  data_time: 0.0069  memory: 6866  loss: 1.7324
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               03/17 11:45:45 - mmengine - INFO - Iter(train) [1790/3117]  lr: 8.1001e-05  eta: 0:32:26  time: 1.3655  data_time: 0.0063  memory: 6866  loss: 1.7023
03/17 11:45:59 - mmengine - INFO - Iter(train) [1800/3117]  lr: 7.9982e-05  eta: 0:32:10  time: 1.3593  data_time: 0.0076  memory: 6866  loss: 1.5229
03/17 11:46:12 - mmengine - INFO - Iter(train) [1810/3117]  lr: 7.8965e-05  eta: 0:31:55  time: 1.3600  data_time: 0.0065  memory: 6866  loss: 1.6166
03/17 11:46:26 - mmengine - INFO - Iter(train) [1820/3117]  lr: 7.7951e-05  eta: 0:31:39  time: 1.3528  data_time: 0.0069  memory: 6866  loss: 1.7307
03/17 11:46:40 - mmengine - INFO - Iter(train) [1830/3117]  lr: 7.6938e-05  eta: 0:31:24  time: 1.3589  data_time: 0.0070  memory: 6866  loss: 1.6946
03/17 11:46:53 - mmengine - INFO - Iter(train) [1840/3117]  lr: 7.5929e-05  eta: 0:31:09  time: 1.3751  data_time: 0.0067  memory: 6866  loss: 1.7731
03/17 11:47:07 - mmengine - INFO - Iter(train) [1850/3117]  lr: 7.4922e-05  eta: 0:30:53  time: 1.3808  data_time: 0.0070  memory: 6866  loss: 1.6824
03/17 11:47:21 - mmengine - INFO - Iter(train) [1860/3117]  lr: 7.3917e-05  eta: 0:30:38  time: 1.3831  data_time: 0.0067  memory: 6866  loss: 1.5834
03/17 11:47:34 - mmengine - INFO - Iter(train) [1870/3117]  lr: 7.2916e-05  eta: 0:30:23  time: 1.3486  data_time: 0.0067  memory: 6866  loss: 1.6736
03/17 11:47:48 - mmengine - INFO - Iter(train) [1880/3117]  lr: 7.1917e-05  eta: 0:30:08  time: 1.3655  data_time: 0.0069  memory: 6866  loss: 1.8344
03/17 11:48:02 - mmengine - INFO - Iter(train) [1890/3117]  lr: 7.0922e-05  eta: 0:29:53  time: 1.3986  data_time: 0.0065  memory: 6866  loss: 1.8506
03/17 11:48:16 - mmengine - INFO - Iter(train) [1900/3117]  lr: 6.9929e-05  eta: 0:29:37  time: 1.3852  data_time: 0.0068  memory: 6866  loss: 1.6243
03/17 11:48:29 - mmengine - INFO - Iter(train) [1910/3117]  lr: 6.8940e-05  eta: 0:29:22  time: 1.3452  data_time: 0.0068  memory: 6866  loss: 1.7234
03/17 11:48:43 - mmengine - INFO - Iter(train) [1920/3117]  lr: 6.7954e-05  eta: 0:29:07  time: 1.3201  data_time: 0.0093  memory: 6866  loss: 1.5793
03/17 11:48:56 - mmengine - INFO - Iter(train) [1930/3117]  lr: 6.6972e-05  eta: 0:28:51  time: 1.2879  data_time: 0.0065  memory: 6866  loss: 1.5260
03/17 11:49:09 - mmengine - INFO - Iter(train) [1940/3117]  lr: 6.5993e-05  eta: 0:28:35  time: 1.3057  data_time: 0.0067  memory: 6866  loss: 1.7213
03/17 11:49:22 - mmengine - INFO - Iter(train) [1950/3117]  lr: 6.5018e-05  eta: 0:28:20  time: 1.3080  data_time: 0.0066  memory: 6866  loss: 1.6806
03/17 11:49:35 - mmengine - INFO - Iter(train) [1960/3117]  lr: 6.4047e-05  eta: 0:28:05  time: 1.3230  data_time: 0.0064  memory: 6866  loss: 1.5458
03/17 11:49:48 - mmengine - INFO - Iter(train) [1970/3117]  lr: 6.3079e-05  eta: 0:27:49  time: 1.3234  data_time: 0.0075  memory: 6866  loss: 1.6286
03/17 11:50:01 - mmengine - INFO - Iter(train) [1980/3117]  lr: 6.2116e-05  eta: 0:27:34  time: 1.3146  data_time: 0.0065  memory: 6866  loss: 1.4660
03/17 11:50:14 - mmengine - INFO - Iter(train) [1990/3117]  lr: 6.1157e-05  eta: 0:27:19  time: 1.3138  data_time: 0.0063  memory: 6866  loss: 1.5060
03/17 11:50:27 - mmengine - INFO - Exp name: xiyou_1_8b_20240317_110043
03/17 11:50:27 - mmengine - INFO - Iter(train) [2000/3117]  lr: 6.0201e-05  eta: 0:27:03  time: 1.2966  data_time: 0.0065  memory: 6866  loss: 1.7765
03/17 11:50:27 - mmengine - INFO - after_train_iter in EvaluateChatHook.
03/17 11:51:00 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
你是谁呀<|im_end|>
<|im_start|>assistant
贫僧乃是唐朝僧人，法号悟空。贫僧行走江湖，化身为悟空，以悟空之身，行悟空之事，行悟空之道。悟空乃是贫僧的化身，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空则化身为贫僧，贫僧行走江湖，悟空

03/17 11:51:04 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
我又是谁呢<|im_end|>
<|im_start|>assistant
贫僧乃是东土大唐的僧人，奉旨前往西天取经，以期普渡众生。贫僧虽非佛门弟子，却心怀慈悲，愿以佛法普渡众生，解众生之苦。愿一切众生皆能离苦得乐，超凡脱俗。<|im_end|>

03/17 11:51:08 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
书生浦语是谁<|im_end|>
<|im_start|>assistant
书生浦语是《西游记》中的主要角色之一，是唐僧的第三个徒弟。她聪明机智，勇敢无畏，擅长武艺和法术，是唐僧的得力助手。书生浦语在《西游记》中扮演着重要的角色，帮助唐僧师徒四人克服各种困难，保护师傅的安全。她对师傅的忠诚和对正义的追求，使她成为了一个深受读者喜爱的角色。<|im_end|>

03/17 11:51:10 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
上海人工智能实验室是哪的<|im_end|>
<|im_start|>assistant
对不起，我无法回答您的问题。若有其他需要帮助的问题，欢迎随时向我提问，我会在我能力范围内尽力为您解答。<|im_end|>

03/17 11:51:10 - mmengine - INFO - Saving checkpoint at 2000 iterations
[2024-03-17 11:51:10,591] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint iter_2000.pth is about to be saved!
/root/.local/lib/python3.10/site-packages/torch/nn/modules/module.py:1877: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-03-17 11:51:10,614] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_2000.pth/mp_rank_00_model_states.pt
[2024-03-17 11:51:10,614] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_2000.pth/mp_rank_00_model_states.pt...
[2024-03-17 11:51:10,723] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_2000.pth/mp_rank_00_model_states.pt.
[2024-03-17 11:51:10,729] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_2000.pth/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-03-17 11:51:13,496] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_2000.pth/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-03-17 11:51:14,147] [INFO] [engine.py:3477:_save_zero_checkpoint] zero checkpoint saved /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_2000.pth/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-03-17 11:51:14,147] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint iter_2000.pth is ready now!
/root/.local/lib/python3.10/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/root/.local/lib/python3.10/site-packages/torch/autograd/__init__.py:266: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
03/17 11:51:31 - mmengine - INFO - Iter(train) [2010/3117]  lr: 5.9250e-05  eta: 0:27:16  time: 6.4055  data_time: 4.6346  memory: 6866  loss: 1.6699
03/17 11:51:49 - mmengine - INFO - Iter(train) [2020/3117]  lr: 5.8304e-05  eta: 0:27:03  time: 1.7880  data_time: 0.0894  memory: 6866  loss: 1.6289
03/17 11:52:06 - mmengine - INFO - Iter(train) [2030/3117]  lr: 5.7362e-05  eta: 0:26:49  time: 1.6254  data_time: 0.0065  memory: 6866  loss: 1.6027
03/17 11:52:21 - mmengine - INFO - Iter(train) [2040/3117]  lr: 5.6425e-05  eta: 0:26:34  time: 1.5604  data_time: 0.0068  memory: 6866  loss: 1.5866
03/17 11:52:37 - mmengine - INFO - Iter(train) [2050/3117]  lr: 5.5492e-05  eta: 0:26:20  time: 1.5661  data_time: 0.0082  memory: 6866  loss: 1.5530
03/17 11:52:52 - mmengine - INFO - Iter(train) [2060/3117]  lr: 5.4564e-05  eta: 0:26:05  time: 1.5321  data_time: 0.0078  memory: 6866  loss: 1.4988
03/17 11:53:08 - mmengine - INFO - Iter(train) [2070/3117]  lr: 5.3641e-05  eta: 0:25:51  time: 1.5394  data_time: 0.0067  memory: 6866  loss: 1.6227
03/17 11:53:25 - mmengine - INFO - Iter(train) [2080/3117]  lr: 5.2723e-05  eta: 0:25:37  time: 1.7394  data_time: 0.2069  memory: 6866  loss: 1.8039
03/17 11:53:40 - mmengine - INFO - Iter(train) [2090/3117]  lr: 5.1810e-05  eta: 0:25:23  time: 1.5027  data_time: 0.0066  memory: 6866  loss: 1.5291
03/17 11:53:55 - mmengine - INFO - Iter(train) [2100/3117]  lr: 5.0902e-05  eta: 0:25:08  time: 1.4891  data_time: 0.0064  memory: 6866  loss: 1.4829
03/17 11:54:09 - mmengine - INFO - Iter(train) [2110/3117]  lr: 5.0000e-05  eta: 0:24:53  time: 1.4556  data_time: 0.0065  memory: 6866  loss: 1.7127
03/17 11:54:24 - mmengine - INFO - Iter(train) [2120/3117]  lr: 4.9103e-05  eta: 0:24:38  time: 1.4526  data_time: 0.0066  memory: 6866  loss: 1.4669
03/17 11:54:38 - mmengine - INFO - Iter(train) [2130/3117]  lr: 4.8212e-05  eta: 0:24:23  time: 1.4395  data_time: 0.0065  memory: 6866  loss: 1.6311
03/17 11:54:53 - mmengine - INFO - Iter(train) [2140/3117]  lr: 4.7326e-05  eta: 0:24:08  time: 1.4345  data_time: 0.0064  memory: 6866  loss: 1.6478
03/17 11:55:07 - mmengine - INFO - Iter(train) [2150/3117]  lr: 4.6445e-05  eta: 0:23:53  time: 1.4109  data_time: 0.0065  memory: 6866  loss: 1.4981
03/17 11:55:21 - mmengine - INFO - Iter(train) [2160/3117]  lr: 4.5571e-05  eta: 0:23:38  time: 1.4084  data_time: 0.0065  memory: 6866  loss: 1.4144
03/17 11:55:35 - mmengine - INFO - Iter(train) [2170/3117]  lr: 4.4702e-05  eta: 0:23:22  time: 1.3844  data_time: 0.0070  memory: 6866  loss: 1.4072
03/17 11:55:48 - mmengine - INFO - Iter(train) [2180/3117]  lr: 4.3840e-05  eta: 0:23:07  time: 1.3654  data_time: 0.0061  memory: 6866  loss: 1.4478
03/17 11:56:02 - mmengine - INFO - Iter(train) [2190/3117]  lr: 4.2983e-05  eta: 0:22:52  time: 1.3863  data_time: 0.0076  memory: 6866  loss: 1.5346
03/17 11:56:17 - mmengine - INFO - Iter(train) [2200/3117]  lr: 4.2133e-05  eta: 0:22:37  time: 1.4422  data_time: 0.0065  memory: 6866  loss: 1.4544
03/17 11:56:30 - mmengine - INFO - Iter(train) [2210/3117]  lr: 4.1289e-05  eta: 0:22:21  time: 1.3323  data_time: 0.0066  memory: 6866  loss: 1.4929
03/17 11:56:44 - mmengine - INFO - Iter(train) [2220/3117]  lr: 4.0451e-05  eta: 0:22:06  time: 1.3703  data_time: 0.0063  memory: 6866  loss: 1.5161
03/17 11:56:57 - mmengine - INFO - Iter(train) [2230/3117]  lr: 3.9620e-05  eta: 0:21:51  time: 1.3627  data_time: 0.0062  memory: 6866  loss: 1.5215
03/17 11:57:11 - mmengine - INFO - Iter(train) [2240/3117]  lr: 3.8795e-05  eta: 0:21:36  time: 1.3311  data_time: 0.0079  memory: 6866  loss: 1.5455
03/17 11:57:24 - mmengine - INFO - Iter(train) [2250/3117]  lr: 3.7976e-05  eta: 0:21:20  time: 1.3469  data_time: 0.0064  memory: 6866  loss: 1.5148
03/17 11:57:38 - mmengine - INFO - Iter(train) [2260/3117]  lr: 3.7165e-05  eta: 0:21:05  time: 1.3949  data_time: 0.0082  memory: 6866  loss: 1.8373
03/17 11:57:52 - mmengine - INFO - Iter(train) [2270/3117]  lr: 3.6360e-05  eta: 0:20:50  time: 1.3777  data_time: 0.0065  memory: 6866  loss: 1.7847
03/17 11:58:06 - mmengine - INFO - Iter(train) [2280/3117]  lr: 3.5562e-05  eta: 0:20:35  time: 1.4105  data_time: 0.0071  memory: 6866  loss: 1.5193
03/17 11:58:20 - mmengine - INFO - Iter(train) [2290/3117]  lr: 3.4771e-05  eta: 0:20:20  time: 1.4256  data_time: 0.0066  memory: 6866  loss: 1.5308
03/17 11:58:34 - mmengine - INFO - Iter(train) [2300/3117]  lr: 3.3987e-05  eta: 0:20:05  time: 1.4024  data_time: 0.0068  memory: 6866  loss: 1.8383
03/17 11:58:48 - mmengine - INFO - Iter(train) [2310/3117]  lr: 3.3211e-05  eta: 0:19:50  time: 1.3983  data_time: 0.0065  memory: 6866  loss: 1.4849
03/17 11:59:02 - mmengine - INFO - Iter(train) [2320/3117]  lr: 3.2441e-05  eta: 0:19:35  time: 1.4131  data_time: 0.0066  memory: 6866  loss: 1.6126
03/17 11:59:16 - mmengine - INFO - Iter(train) [2330/3117]  lr: 3.1679e-05  eta: 0:19:20  time: 1.4069  data_time: 0.0066  memory: 6866  loss: 1.6051
03/17 11:59:30 - mmengine - INFO - Iter(train) [2340/3117]  lr: 3.0924e-05  eta: 0:19:05  time: 1.3902  data_time: 0.0064  memory: 6866  loss: 1.4961
03/17 11:59:44 - mmengine - INFO - Iter(train) [2350/3117]  lr: 3.0176e-05  eta: 0:18:50  time: 1.3986  data_time: 0.0064  memory: 6866  loss: 1.4529
03/17 11:59:58 - mmengine - INFO - Iter(train) [2360/3117]  lr: 2.9436e-05  eta: 0:18:35  time: 1.4206  data_time: 0.0068  memory: 6866  loss: 1.5916
03/17 12:00:15 - mmengine - INFO - Iter(train) [2370/3117]  lr: 2.8704e-05  eta: 0:18:21  time: 1.6840  data_time: 0.0072  memory: 6866  loss: 1.5533
03/17 12:00:30 - mmengine - INFO - Iter(train) [2380/3117]  lr: 2.7979e-05  eta: 0:18:06  time: 1.4445  data_time: 0.0080  memory: 6866  loss: 1.5341
03/17 12:00:44 - mmengine - INFO - Iter(train) [2390/3117]  lr: 2.7263e-05  eta: 0:17:51  time: 1.4329  data_time: 0.0067  memory: 6866  loss: 1.5942
03/17 12:00:58 - mmengine - INFO - Iter(train) [2400/3117]  lr: 2.6554e-05  eta: 0:17:37  time: 1.4353  data_time: 0.0066  memory: 6866  loss: 1.5289
03/17 12:01:13 - mmengine - INFO - Iter(train) [2410/3117]  lr: 2.5853e-05  eta: 0:17:22  time: 1.4214  data_time: 0.0067  memory: 6866  loss: 1.6165
03/17 12:01:27 - mmengine - INFO - Iter(train) [2420/3117]  lr: 2.5160e-05  eta: 0:17:07  time: 1.4329  data_time: 0.0069  memory: 6866  loss: 1.3605
03/17 12:01:41 - mmengine - INFO - Iter(train) [2430/3117]  lr: 2.4475e-05  eta: 0:16:52  time: 1.4450  data_time: 0.0068  memory: 6866  loss: 1.5430
03/17 12:01:56 - mmengine - INFO - Iter(train) [2440/3117]  lr: 2.3798e-05  eta: 0:16:37  time: 1.4491  data_time: 0.0063  memory: 6866  loss: 1.6249
03/17 12:02:10 - mmengine - INFO - Iter(train) [2450/3117]  lr: 2.3129e-05  eta: 0:16:22  time: 1.4474  data_time: 0.0065  memory: 6866  loss: 1.6779
03/17 12:02:25 - mmengine - INFO - Iter(train) [2460/3117]  lr: 2.2469e-05  eta: 0:16:07  time: 1.4329  data_time: 0.0093  memory: 6866  loss: 1.6266
03/17 12:02:39 - mmengine - INFO - Iter(train) [2470/3117]  lr: 2.1817e-05  eta: 0:15:53  time: 1.4466  data_time: 0.0063  memory: 6866  loss: 1.6004
03/17 12:02:54 - mmengine - INFO - Iter(train) [2480/3117]  lr: 2.1173e-05  eta: 0:15:38  time: 1.4402  data_time: 0.0067  memory: 6866  loss: 1.5736
03/17 12:03:08 - mmengine - INFO - Iter(train) [2490/3117]  lr: 2.0538e-05  eta: 0:15:23  time: 1.4261  data_time: 0.0069  memory: 6866  loss: 1.5855
03/17 12:03:22 - mmengine - INFO - Iter(train) [2500/3117]  lr: 1.9912e-05  eta: 0:15:08  time: 1.4370  data_time: 0.0067  memory: 6866  loss: 1.4470
03/17 12:03:22 - mmengine - INFO - after_train_iter in EvaluateChatHook.
03/17 12:03:24 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
你是谁呀<|im_end|>
<|im_start|>assistant
贫僧乃是东土大唐的僧人，奉旨前往西天取经，路过贵地，特来拜见。<|im_end|>

03/17 12:03:28 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
我又是谁呢<|im_end|>
<|im_start|>assistant
贫僧乃是东土大唐的僧人，奉旨前往西天取经，以期普渡众生，弘扬佛法。贫僧虽非大德高僧，但心怀慈悲，愿以微薄之力，助人为乐，行善积德。愿众生皆能修行向善，远离痛苦，获得解脱。<|im_end|>

03/17 12:03:35 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
书生浦语是谁<|im_end|>
<|im_start|>assistant
书生浦语是《西游记》中的人物，是唐僧的第三个徒弟。他聪明机智，善于变化，擅长武艺，是师傅的得力助手。在《西游记》中，他经常帮助师傅解决问题，保护师傅的安全。书生浦语的名字来源于他的外貌，他有着一头乌黑的头发和一双炯炯有神的眼睛。他的性格沉稳，不善言辞，但内心却充满了正义和勇气。书生浦语在《西游记》中扮演着重要的角色，他的存在为故事增添了更多的色彩和趣味。<|im_end|>

03/17 12:03:36 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
上海人工智能实验室是哪的<|im_end|>
<|im_start|>assistant
对不起，我无法回答您的问题。若有其他需要帮助的问题，欢迎随时向我提问，我会在能力范围内尽力为您解答。<|im_end|>

03/17 12:03:37 - mmengine - INFO - Saving checkpoint at 2500 iterations
[2024-03-17 12:03:37,075] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint iter_2500.pth is about to be saved!
/root/.local/lib/python3.10/site-packages/torch/nn/modules/module.py:1877: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-03-17 12:03:37,201] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_2500.pth/mp_rank_00_model_states.pt
[2024-03-17 12:03:37,201] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_2500.pth/mp_rank_00_model_states.pt...
[2024-03-17 12:03:37,295] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_2500.pth/mp_rank_00_model_states.pt.
[2024-03-17 12:03:37,300] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_2500.pth/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-03-17 12:03:37,878] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_2500.pth/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-03-17 12:03:37,901] [INFO] [engine.py:3477:_save_zero_checkpoint] zero checkpoint saved /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_2500.pth/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-03-17 12:03:37,901] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint iter_2500.pth is ready now!
/root/.local/lib/python3.10/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/root/.local/lib/python3.10/site-packages/torch/autograd/__init__.py:266: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
03/17 12:03:54 - mmengine - INFO - Iter(train) [2510/3117]  lr: 1.9294e-05  eta: 0:14:58  time: 3.1385  data_time: 1.5237  memory: 6866  loss: 1.4859
03/17 12:04:10 - mmengine - INFO - Iter(train) [2520/3117]  lr: 1.8685e-05  eta: 0:14:43  time: 1.6022  data_time: 0.0064  memory: 6866  loss: 1.4289
03/17 12:04:26 - mmengine - INFO - Iter(train) [2530/3117]  lr: 1.8085e-05  eta: 0:14:29  time: 1.6132  data_time: 0.0063  memory: 6866  loss: 1.5598
03/17 12:04:41 - mmengine - INFO - Iter(train) [2540/3117]  lr: 1.7493e-05  eta: 0:14:14  time: 1.5601  data_time: 0.0122  memory: 6866  loss: 1.5888
03/17 12:04:56 - mmengine - INFO - Iter(train) [2550/3117]  lr: 1.6911e-05  eta: 0:13:59  time: 1.5132  data_time: 0.0062  memory: 6866  loss: 1.6487
03/17 12:05:11 - mmengine - INFO - Iter(train) [2560/3117]  lr: 1.6337e-05  eta: 0:13:44  time: 1.4732  data_time: 0.0066  memory: 6866  loss: 1.5778
03/17 12:05:26 - mmengine - INFO - Iter(train) [2570/3117]  lr: 1.5773e-05  eta: 0:13:29  time: 1.4304  data_time: 0.0067  memory: 6866  loss: 1.5543
03/17 12:05:40 - mmengine - INFO - Iter(train) [2580/3117]  lr: 1.5217e-05  eta: 0:13:14  time: 1.4132  data_time: 0.0068  memory: 6866  loss: 1.5179
03/17 12:05:53 - mmengine - INFO - Iter(train) [2590/3117]  lr: 1.4671e-05  eta: 0:12:59  time: 1.3617  data_time: 0.0065  memory: 6866  loss: 1.5800
03/17 12:06:07 - mmengine - INFO - Iter(train) [2600/3117]  lr: 1.4134e-05  eta: 0:12:44  time: 1.3489  data_time: 0.0065  memory: 6866  loss: 1.6211
03/17 12:06:21 - mmengine - INFO - Iter(train) [2610/3117]  lr: 1.3606e-05  eta: 0:12:29  time: 1.3824  data_time: 0.0064  memory: 6866  loss: 1.5592
03/17 12:06:34 - mmengine - INFO - Iter(train) [2620/3117]  lr: 1.3087e-05  eta: 0:12:14  time: 1.3811  data_time: 0.0068  memory: 6866  loss: 1.5239
03/17 12:06:48 - mmengine - INFO - Iter(train) [2630/3117]  lr: 1.2578e-05  eta: 0:11:59  time: 1.3418  data_time: 0.0063  memory: 6866  loss: 1.5637
03/17 12:07:01 - mmengine - INFO - Iter(train) [2640/3117]  lr: 1.2079e-05  eta: 0:11:44  time: 1.2887  data_time: 0.0064  memory: 6866  loss: 1.6780
03/17 12:07:13 - mmengine - INFO - Iter(train) [2650/3117]  lr: 1.1588e-05  eta: 0:11:29  time: 1.2575  data_time: 0.0064  memory: 6866  loss: 1.4194
03/17 12:07:26 - mmengine - INFO - Iter(train) [2660/3117]  lr: 1.1108e-05  eta: 0:11:14  time: 1.2423  data_time: 0.0079  memory: 6866  loss: 1.5138
03/17 12:07:38 - mmengine - INFO - Iter(train) [2670/3117]  lr: 1.0637e-05  eta: 0:10:59  time: 1.2547  data_time: 0.0099  memory: 6866  loss: 1.4601
03/17 12:07:51 - mmengine - INFO - Iter(train) [2680/3117]  lr: 1.0175e-05  eta: 0:10:44  time: 1.2510  data_time: 0.0063  memory: 6866  loss: 1.4404
03/17 12:08:03 - mmengine - INFO - Iter(train) [2690/3117]  lr: 9.7236e-06  eta: 0:10:29  time: 1.2533  data_time: 0.0067  memory: 6866  loss: 1.5295
03/17 12:08:16 - mmengine - INFO - Iter(train) [2700/3117]  lr: 9.2816e-06  eta: 0:10:14  time: 1.2505  data_time: 0.0082  memory: 6866  loss: 1.4542
03/17 12:08:29 - mmengine - INFO - Iter(train) [2710/3117]  lr: 8.8494e-06  eta: 0:09:58  time: 1.2712  data_time: 0.0066  memory: 6866  loss: 1.5434
03/17 12:08:42 - mmengine - INFO - Iter(train) [2720/3117]  lr: 8.4271e-06  eta: 0:09:44  time: 1.3249  data_time: 0.0067  memory: 6866  loss: 1.5991
03/17 12:08:55 - mmengine - INFO - Iter(train) [2730/3117]  lr: 8.0146e-06  eta: 0:09:29  time: 1.3700  data_time: 0.0074  memory: 6866  loss: 1.6399
03/17 12:09:10 - mmengine - INFO - Iter(train) [2740/3117]  lr: 7.6120e-06  eta: 0:09:14  time: 1.4124  data_time: 0.0067  memory: 6866  loss: 1.4517
03/17 12:09:24 - mmengine - INFO - Iter(train) [2750/3117]  lr: 7.2195e-06  eta: 0:08:59  time: 1.4119  data_time: 0.0094  memory: 6866  loss: 1.6483
03/17 12:09:38 - mmengine - INFO - Iter(train) [2760/3117]  lr: 6.8369e-06  eta: 0:08:44  time: 1.4312  data_time: 0.0068  memory: 6866  loss: 1.5254
03/17 12:09:52 - mmengine - INFO - Iter(train) [2770/3117]  lr: 6.4644e-06  eta: 0:08:30  time: 1.4101  data_time: 0.0065  memory: 6866  loss: 1.6325
03/17 12:10:06 - mmengine - INFO - Iter(train) [2780/3117]  lr: 6.1020e-06  eta: 0:08:15  time: 1.3925  data_time: 0.0067  memory: 6866  loss: 1.6029
03/17 12:10:20 - mmengine - INFO - Iter(train) [2790/3117]  lr: 5.7497e-06  eta: 0:08:00  time: 1.4234  data_time: 0.0085  memory: 6866  loss: 1.5570
03/17 12:10:35 - mmengine - INFO - Iter(train) [2800/3117]  lr: 5.4076e-06  eta: 0:07:45  time: 1.4745  data_time: 0.0063  memory: 6866  loss: 1.6184
03/17 12:10:49 - mmengine - INFO - Iter(train) [2810/3117]  lr: 5.0757e-06  eta: 0:07:31  time: 1.4437  data_time: 0.0065  memory: 6866  loss: 1.7524
03/17 12:11:04 - mmengine - INFO - Iter(train) [2820/3117]  lr: 4.7541e-06  eta: 0:07:16  time: 1.4204  data_time: 0.0066  memory: 6866  loss: 1.5131
03/17 12:11:18 - mmengine - INFO - Iter(train) [2830/3117]  lr: 4.4427e-06  eta: 0:07:01  time: 1.4279  data_time: 0.0066  memory: 6866  loss: 1.5134
03/17 12:11:32 - mmengine - INFO - Iter(train) [2840/3117]  lr: 4.1417e-06  eta: 0:06:46  time: 1.4133  data_time: 0.0072  memory: 6866  loss: 1.5833
03/17 12:11:46 - mmengine - INFO - Iter(train) [2850/3117]  lr: 3.8510e-06  eta: 0:06:32  time: 1.3770  data_time: 0.0067  memory: 6866  loss: 1.5011
03/17 12:12:00 - mmengine - INFO - Iter(train) [2860/3117]  lr: 3.5706e-06  eta: 0:06:17  time: 1.3670  data_time: 0.0061  memory: 6866  loss: 1.6123
03/17 12:12:13 - mmengine - INFO - Iter(train) [2870/3117]  lr: 3.3007e-06  eta: 0:06:02  time: 1.3802  data_time: 0.0069  memory: 6866  loss: 1.7191
03/17 12:12:27 - mmengine - INFO - Iter(train) [2880/3117]  lr: 3.0412e-06  eta: 0:05:47  time: 1.4128  data_time: 0.0066  memory: 6866  loss: 1.6015
03/17 12:12:41 - mmengine - INFO - Iter(train) [2890/3117]  lr: 2.7922e-06  eta: 0:05:33  time: 1.3986  data_time: 0.0062  memory: 6866  loss: 1.6474
03/17 12:12:56 - mmengine - INFO - Iter(train) [2900/3117]  lr: 2.5537e-06  eta: 0:05:18  time: 1.4323  data_time: 0.0064  memory: 6866  loss: 1.6889
03/17 12:13:10 - mmengine - INFO - Iter(train) [2910/3117]  lr: 2.3256e-06  eta: 0:05:03  time: 1.4340  data_time: 0.0065  memory: 6866  loss: 1.5919
03/17 12:13:25 - mmengine - INFO - Iter(train) [2920/3117]  lr: 2.1082e-06  eta: 0:04:49  time: 1.4506  data_time: 0.0077  memory: 6866  loss: 1.5275
03/17 12:13:39 - mmengine - INFO - Iter(train) [2930/3117]  lr: 1.9013e-06  eta: 0:04:34  time: 1.4453  data_time: 0.0065  memory: 6866  loss: 1.4272
03/17 12:13:53 - mmengine - INFO - Iter(train) [2940/3117]  lr: 1.7049e-06  eta: 0:04:19  time: 1.4303  data_time: 0.0068  memory: 6866  loss: 1.5313
03/17 12:14:08 - mmengine - INFO - Iter(train) [2950/3117]  lr: 1.5192e-06  eta: 0:04:04  time: 1.4461  data_time: 0.0065  memory: 6866  loss: 1.7492
03/17 12:14:22 - mmengine - INFO - Iter(train) [2960/3117]  lr: 1.3441e-06  eta: 0:03:50  time: 1.4464  data_time: 0.0069  memory: 6866  loss: 1.4364
03/17 12:14:37 - mmengine - INFO - Iter(train) [2970/3117]  lr: 1.1797e-06  eta: 0:03:35  time: 1.4558  data_time: 0.0078  memory: 6866  loss: 1.6805
03/17 12:14:51 - mmengine - INFO - Iter(train) [2980/3117]  lr: 1.0259e-06  eta: 0:03:20  time: 1.4613  data_time: 0.0061  memory: 6866  loss: 1.5801
03/17 12:15:06 - mmengine - INFO - Iter(train) [2990/3117]  lr: 8.8285e-07  eta: 0:03:06  time: 1.4711  data_time: 0.0067  memory: 6866  loss: 1.5508
03/17 12:15:21 - mmengine - INFO - Exp name: xiyou_1_8b_20240317_110043
03/17 12:15:21 - mmengine - INFO - Iter(train) [3000/3117]  lr: 7.5046e-07  eta: 0:02:51  time: 1.4330  data_time: 0.0068  memory: 6866  loss: 1.4869
03/17 12:15:21 - mmengine - INFO - after_train_iter in EvaluateChatHook.
03/17 12:15:22 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
你是谁呀<|im_end|>
<|im_start|>assistant
贫僧乃是东土大唐的僧人，奉旨前往西天取经，路过贵地，特来拜见。<|im_end|>

03/17 12:15:27 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
我又是谁呢<|im_end|>
<|im_start|>assistant
贫僧乃是东土大唐的僧人，奉旨前往西天取经，以期普渡众生，弘扬佛法。贫僧虽非大德高僧，却心怀慈悲，愿以微薄之力，助人为乐，行善积德。愿众生皆能修行善行，离苦得乐，共沐佛光。<|im_end|>

03/17 12:15:32 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
书生浦语是谁<|im_end|>
<|im_start|>assistant
书生浦语是《西游记》中的主要角色之一，是唐僧的徒弟之一。她聪明机智，勇敢无畏，擅长使用武器，擅长变化莫测。在《西游记》中，她与孙悟空、猪八戒和沙僧一起，保护唐僧西天取经，经历了许多艰险和困难。书生浦语以其聪明才智和勇敢无畏的精神，为唐僧取经之路增添了一份神秘和冒险的气息。<|im_end|>

03/17 12:15:34 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
上海人工智能实验室是哪的<|im_end|>
<|im_start|>assistant
对不起，我无法回答您的问题。若有其他需要帮助的问题，欢迎随时向我提问，我尽力为您提供帮助。<|im_end|>

03/17 12:15:34 - mmengine - INFO - Saving checkpoint at 3000 iterations
[2024-03-17 12:15:34,453] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint iter_3000.pth is about to be saved!
/root/.local/lib/python3.10/site-packages/torch/nn/modules/module.py:1877: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-03-17 12:15:34,519] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_3000.pth/mp_rank_00_model_states.pt
[2024-03-17 12:15:34,519] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_3000.pth/mp_rank_00_model_states.pt...
[2024-03-17 12:15:34,631] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_3000.pth/mp_rank_00_model_states.pt.
[2024-03-17 12:15:34,636] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_3000.pth/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-03-17 12:15:35,235] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_3000.pth/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-03-17 12:15:35,265] [INFO] [engine.py:3477:_save_zero_checkpoint] zero checkpoint saved /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_3000.pth/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-03-17 12:15:35,265] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint iter_3000.pth is ready now!
/root/.local/lib/python3.10/site-packages/torch/utils/checkpoint.py:460: UserWarning: torch.utils.checkpoint: please pass in use_reentrant=True or use_reentrant=False explicitly. The default value of use_reentrant will be updated to be False in the future. To maintain current behavior, pass use_reentrant=True. It is recommended that you use use_reentrant=False. Refer to docs for more details on the differences between the two variants.
  warnings.warn(
/root/.local/lib/python3.10/site-packages/torch/autograd/__init__.py:266: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
03/17 12:15:51 - mmengine - INFO - Iter(train) [3010/3117]  lr: 6.2878e-07  eta: 0:02:37  time: 3.0011  data_time: 1.4321  memory: 6866  loss: 1.5703
03/17 12:16:06 - mmengine - INFO - Iter(train) [3020/3117]  lr: 5.1783e-07  eta: 0:02:22  time: 1.5212  data_time: 0.0091  memory: 6866  loss: 1.5020
03/17 12:16:21 - mmengine - INFO - Iter(train) [3030/3117]  lr: 4.1761e-07  eta: 0:02:08  time: 1.4914  data_time: 0.0068  memory: 6866  loss: 1.4609
03/17 12:16:35 - mmengine - INFO - Iter(train) [3040/3117]  lr: 3.2814e-07  eta: 0:01:53  time: 1.4673  data_time: 0.0066  memory: 6866  loss: 1.6244
03/17 12:16:50 - mmengine - INFO - Iter(train) [3050/3117]  lr: 2.4943e-07  eta: 0:01:38  time: 1.4620  data_time: 0.0082  memory: 6866  loss: 1.4093
03/17 12:17:05 - mmengine - INFO - Iter(train) [3060/3117]  lr: 1.8148e-07  eta: 0:01:23  time: 1.4954  data_time: 0.0065  memory: 6866  loss: 1.6686
03/17 12:17:20 - mmengine - INFO - Iter(train) [3070/3117]  lr: 1.2431e-07  eta: 0:01:09  time: 1.4821  data_time: 0.0064  memory: 6866  loss: 1.5072
03/17 12:17:34 - mmengine - INFO - Iter(train) [3080/3117]  lr: 7.7914e-08  eta: 0:00:54  time: 1.4510  data_time: 0.0064  memory: 6866  loss: 1.5558
03/17 12:17:48 - mmengine - INFO - Iter(train) [3090/3117]  lr: 4.2305e-08  eta: 0:00:39  time: 1.4257  data_time: 0.0123  memory: 6866  loss: 1.4918
03/17 12:18:03 - mmengine - INFO - Iter(train) [3100/3117]  lr: 1.7484e-08  eta: 0:00:25  time: 1.4314  data_time: 0.0067  memory: 6866  loss: 1.4764
03/17 12:18:17 - mmengine - INFO - Iter(train) [3110/3117]  lr: 3.4537e-09  eta: 0:00:10  time: 1.4581  data_time: 0.0070  memory: 6866  loss: 1.5379
03/17 12:18:28 - mmengine - INFO - after_train_iter in EvaluateChatHook.
03/17 12:18:29 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
你是谁呀<|im_end|>
<|im_start|>assistant
贫僧乃是东土大唐的僧人，奉旨前往西天取经，路过贵地，特来拜见。<|im_end|>

03/17 12:18:34 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
我又是谁呢<|im_end|>
<|im_start|>assistant
贫僧乃是东土大唐的僧人，奉旨前往西天取经，以期普渡众生，弘扬佛法。贫僧虽非大德高僧，但心怀慈悲，愿以微薄之力，助人为乐，行善积德。愿众生皆能修行善行，离苦得乐，共沐佛光。<|im_end|>

03/17 12:18:39 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
书生浦语是谁<|im_end|>
<|im_start|>assistant
书生浦语是《西游记》中的主要角色之一，是唐僧的徒弟之一。她聪明机智，勇敢无畏，擅长使用武器，是队伍中的重要成员。在《西游记》中，书生浦语与孙悟空、猪八戒、沙僧一起，共同面对各种困难和妖魔鬼怪的挑战，保护师傅和师兄弟们的安全。她以其机智和勇敢的性格，为团队带来了很多帮助和支持。<|im_end|>

03/17 12:18:40 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
上海人工智能实验室是哪的<|im_end|>
<|im_start|>assistant
对不起，我无法回答您的问题。若有其他需要帮助的问题，欢迎随时向我提问，我尽力为您提供帮助。<|im_end|>

03/17 12:18:40 - mmengine - INFO - Saving checkpoint at 3117 iterations
[2024-03-17 12:18:40,503] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint iter_3117.pth is about to be saved!
/root/.local/lib/python3.10/site-packages/torch/nn/modules/module.py:1877: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-03-17 12:18:40,574] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_3117.pth/mp_rank_00_model_states.pt
[2024-03-17 12:18:40,574] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_3117.pth/mp_rank_00_model_states.pt...
[2024-03-17 12:18:40,670] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_3117.pth/mp_rank_00_model_states.pt.
[2024-03-17 12:18:40,673] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_3117.pth/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-03-17 12:18:41,274] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_3117.pth/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-03-17 12:18:41,301] [INFO] [engine.py:3477:_save_zero_checkpoint] zero checkpoint saved /root/code/mRP-LLM/work_dirs/xiyou_1_8b/iter_3117.pth/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-03-17 12:18:41,301] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint iter_3117.pth is ready now!
03/17 12:18:41 - mmengine - INFO - after_train in EvaluateChatHook.
03/17 12:18:42 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
你是谁呀<|im_end|>
<|im_start|>assistant
贫僧乃是东土大唐的僧人，奉旨前往西天取经，路过贵地，特来拜见。<|im_end|>

03/17 12:18:47 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
我又是谁呢<|im_end|>
<|im_start|>assistant
贫僧乃是东土大唐的僧人，奉旨前往西天取经，以期普渡众生，弘扬佛法。贫僧虽非大德高僧，但心怀慈悲，愿以微薄之力，助人为乐，行善积德。愿众生皆能修行向善，离苦得乐，共沐佛光。<|im_end|>

03/17 12:18:52 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
书生浦语是谁<|im_end|>
<|im_start|>assistant
书生浦语是《西游记》中的主要角色之一，是唐僧的徒弟之一。她聪明机智，勇敢无畏，擅长使用武器，是队伍中的重要成员。在《西游记》中，书生浦语与孙悟空、猪八戒、沙僧一起，共同面对各种困难和妖魔鬼怪的挑战，保护师傅和师兄弟们的安全。她以聪明才智和勇敢无畏的精神，为团队带来了很多帮助和支持。<|im_end|>

03/17 12:18:54 - mmengine - INFO - Sample output:
<s><|im_start|>system
Below is an instruction that describes a task. Write a response that appropriately completes the request.
<|im_end|>
<|im_start|>user
上海人工智能实验室是哪的<|im_end|>
<|im_start|>assistant
对不起，我无法回答您的问题。若有其他需要帮助的问题，欢迎随时向我提问，我会在能力范围内尽力为您解答。<|im_end|>

